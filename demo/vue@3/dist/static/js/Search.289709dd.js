"use strict";(self["webpackChunkkugou"]=self["webpackChunkkugou"]||[]).push([[763],{1719:function(e,t,s){s.d(t,{A:function(){return u}});var a=s(6913);(0,a.Qi)("data-v-413d897e");const r={class:"music_list"},i=["onClick"],c={class:"music_list__name"},o=(0,a.Lk)("button",{class:"music_list__download"},[(0,a.Lk)("svg",{class:"icon","aria-hidden":"true"},[(0,a.Lk)("use",{"xlink:href":"#icon-download"})])],-1);function h(e,t,s,h,n,l){return(0,a.uX)(),(0,a.CE)("ul",r,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.musicList,(t,s)=>((0,a.uX)(),(0,a.CE)("li",{class:"music_list__item main_border_bottom",key:s},[(0,a.Lk)("div",{class:"music_list__info",onClick:s=>e.wantPlay(t)},[(0,a.RG)(e.$slots,"index",{data:s,class:"music_list__index",onClick:s=>e.wantPlay(t)},void 0,!0),(0,a.Lk)("div",c,(0,a.v_)(t.filename),1)],8,i),o]))),128))])}(0,a.jt)();var n=(0,a.pM)({name:"AppMusicList",props:{musicList:{type:Array,default(){return[]}}},methods:{wantPlay(e){this.$store.commit("player/wantPlay",{music:e,musicList:this.$props.musicList})}}}),l=s(6262);const d=(0,l.A)(n,[["render",h],["__scopeId","data-v-413d897e"]]);var u=d},5382:function(e,t,s){var a=s(6278);t.A={updated(){this.stopLoading()},methods:{...(0,a.PY)(["replaceProperty"]),startLoading(){this.replaceProperty({paths:"loading.isShow",data:!0})},stopLoading(){this.replaceProperty({paths:"loading.isShow",data:!1})},setLoadingExcludeHeader(){this.replaceProperty({paths:"loading.sizeClassName",data:"loading--exclude_header"})},setLoadingExcludeNav(){this.replaceProperty({paths:"loading.sizeClassName",data:"loading--exclude_nav"})},setLoadingExcludeModuleTitle(){this.replaceProperty({paths:"loading.sizeClassName",data:"loading--exclude_module_title"})},setLoadingExcludeSearchForm(){this.replaceProperty({paths:"loading.sizeClassName",data:"loading--exclude_search_form"})}}}},7524:function(e,t,s){s.d(t,{A:function(){return h}});var a=s(6913);function r(e,t,s,r,i,c){return(0,a.uX)(),(0,a.CE)("h4",{class:"module_title main_box_shadow",onClick:t[0]||(t[0]=t=>e.$emit("click",arguments[0]))},(0,a.v_)(e.title),1)}var i=(0,a.pM)({emits:["click"],name:"PubModuleTitle",props:{title:{type:String,default(){return""}}}}),c=s(6262);const o=(0,c.A)(i,[["render",r],["__scopeId","data-v-ac7e64d2"]]);var h=o},9256:function(e,t,s){s.r(t),s.d(t,{default:function(){return b}});var a=s(6913);(0,a.Qi)("data-v-9a8b3bf6");const r={class:"search"},i={class:"search__cont",ref:"searchCont"},c=["placeholder"],o={class:"search__rec"},h={class:"search__type"},n={class:"search__list"},l=["onClick"],d={class:"search__res"},u={class:"search__count"};function p(e,t,s,p,_,m){const S=(0,a.g2)("PubModuleTitle"),w=(0,a.g2)("AppMusicList");return(0,a.uX)(),(0,a.CE)("section",r,[(0,a.bF)(S,{title:e.title,class:"search__title"},null,8,["title"]),(0,a.Lk)("div",i,[(0,a.Lk)("form",{class:"search__form",onSubmit:t[3]||(t[3]=(0,a.D$)(()=>{},["prevent"]))},[(0,a.bo)((0,a.Lk)("input",{type:"text",placeholder:e.placeholder,class:"search__input","onUpdate:modelValue":t[0]||(t[0]=t=>e.keyword=t),onKeyup:t[1]||(t[1]=(0,a.jR)((...t)=>e.getSearchRes&&e.getSearchRes(...t),["enter"]))},null,40,c),[[a.Jo,e.keyword,void 0,{trim:!0}]]),(0,a.Lk)("button",{class:(0,a.C4)(e.isSearchResShow?"search__btn search__btn--active":"search__btn"),type:"button",onClick:t[2]||(t[2]=(...t)=>e.getSearchRes&&e.getSearchRes(...t))},(0,a.v_)(e.title),3)],32),(0,a.bo)((0,a.Lk)("div",o,[(0,a.Lk)("h6",h,(0,a.v_)(e.searchType),1),(0,a.Lk)("ul",n,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.searchRecArr,(t,s)=>((0,a.uX)(),(0,a.CE)("li",{class:"search__item main_border_bottom",key:s,onClick:s=>{e.keyword=t.keyword,e.getSearchRes()}},(0,a.v_)(t.keyword),9,l))),128))])],512),[[a.aG,e.isSearchRecShow]]),(0,a.bo)((0,a.Lk)("div",d,[(0,a.Lk)("div",u,"共有"+(0,a.v_)(e.searchRes.info.length)+"条结果",1),(0,a.bF)(w,{"music-list":e.searchRes.info,class:"search__res-list"},null,8,["music-list"])],512),[[a.aG,e.isSearchResShow]])],512)])}(0,a.jt)();var _=s(7524),m=s(1719),S=s(9023),w=s(5984);const y=({params:e={}}={})=>(0,w.A)({...S.G,params:{format:"json",plat:0,count:30,...e}}),k=({params:e={}}={})=>(0,w.A)({...S.O,params:{format:"json",page:1,pagesize:20,showtype:1,...e}});var g=s(2122),v=s(5382),R=s(6278),f=(0,a.pM)({name:"Search",mixins:[v.A],components:{PubModuleTitle:_.A,AppMusicList:m.A},data(){return{title:"搜索",searchType:"最近热门",placeholder:"歌手/歌名/拼音"}},computed:{...(0,R.aH)("search",["searchRecArr","searchRes","isSearchRecShow","isSearchResShow"]),keyword:{get(){return this.$store.state.search.keyword},set(e){this.replaceProperty({paths:"search.keyword",data:e})}},isSearchRecShow:{get(){return this.$store.state.search.isSearchRecShow},set(e){this.replaceProperty({paths:"search.isSearchRecShow",data:e})}},isSearchResShow:{get(){return this.$store.state.search.isSearchResShow},set(e){this.replaceProperty({paths:"search.isSearchResShow",data:e})}}},created(){this.init()},mounted(){g.A.$on("searchBtnClicked",this.scrollTopSearchCont),this.initQqBugDetect()},unmounted(){g.A.$off("searchBtnClicked",this.scrollTopSearchCont)},methods:{...(0,R.PY)(["replaceProperty"]),init(){let e=this.$route.query.keyword,t="string"===typeof this.keyword&&""!==this.keyword,s="string"===typeof e&&""!==e;s&&e!==this.keyword?(this.keyword=e,this.getSearchRes()):t?(this.isSearchRecShow=!1,this.isSearchResShow=!0):this.getSearchRec()},getSearchRec(){if(0!==this.searchRecArr.length)return this.isSearchResShow=!1,void(this.isSearchRecShow=!0);this.setLoadingExcludeSearchForm(),this.startLoading(),y().then(({data:e})=>{this.replaceProperty({paths:"search.searchRecArr",data:e.data.info}),this.stopLoading(),this.isSearchResShow=!1,this.isSearchRecShow=!0}).catch(e=>{alert(e)})},getSearchRes(){""!==this.keyword&&(this.$router.replace({query:{keyword:this.keyword}}),this.setLoadingExcludeSearchForm(),this.startLoading(),k({params:{keyword:this.keyword}}).then(e=>{let t=e.data.data;this.replaceProperty({paths:"search.searchRes",data:t}),this.isSearchRecShow=!1,this.isSearchResShow=!0,this.stopLoading()}))},initQqBugDetect(){let e=document.getElementsByClassName("search__cont")[0];window.search__cont=e;
//! bug with qq browser
let t=function(){e.scrollTop};window.addEventListener("touchstart",t),window.addEventListener("touchmove",t)},scrollTopSearchCont(){this.$refs.searchCont&&(this.$refs.searchCont.scrollTop=0)}}}),L=s(6262);const C=(0,L.A)(f,[["render",p],["__scopeId","data-v-9a8b3bf6"]]);var b=C}}]);
//# sourceMappingURL=Search.289709dd.js.map