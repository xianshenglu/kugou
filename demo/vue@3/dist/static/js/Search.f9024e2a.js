"use strict";(self["webpackChunkkugou"]=self["webpackChunkkugou"]||[]).push([[763],{1719:function(e,t,s){s.d(t,{A:function(){return p}});var a=s(641),r=s(2644);(0,a.Qi)("data-v-413d897e");const i={class:"music_list"},c=["onClick"],o={class:"music_list__name"},h=(0,a.Lk)("button",{class:"music_list__download"},[(0,a.Lk)("svg",{class:"icon","aria-hidden":"true"},[(0,a.Lk)("use",{"xlink:href":"#icon-download"})])],-1);function n(e,t,s,n,l,d){return(0,a.uX)(),(0,a.CE)("ul",i,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.musicList,(t,s)=>((0,a.uX)(),(0,a.CE)("li",{class:"music_list__item main_border_bottom",key:s},[(0,a.Lk)("div",{class:"music_list__info",onClick:s=>e.wantPlay(t)},[(0,a.RG)(e.$slots,"index",{data:s,class:"music_list__index",onClick:s=>e.wantPlay(t)},void 0,!0),(0,a.Lk)("div",o,(0,r.v_)(t.filename),1)],8,c),h]))),128))])}(0,a.jt)();var l=(0,a.pM)({name:"AppMusicList",props:{musicList:{type:Array,default(){return[]}}},methods:{wantPlay(e){this.$store.commit("player/wantPlay",{music:e,musicList:this.$props.musicList})}}}),d=s(6262);const u=(0,d.A)(l,[["render",n],["__scopeId","data-v-413d897e"]]);var p=u},5382:function(e,t,s){var a=s(6278);t.A={updated(){this.stopLoading()},methods:{...(0,a.PY)(["replaceProperty"]),startLoading(){this.replaceProperty({paths:"loading.isShow",data:!0})},stopLoading(){this.replaceProperty({paths:"loading.isShow",data:!1})},setLoadingExcludeHeader(){this.replaceProperty({paths:"loading.sizeClassName",data:"loading--exclude_header"})},setLoadingExcludeNav(){this.replaceProperty({paths:"loading.sizeClassName",data:"loading--exclude_nav"})},setLoadingExcludeModuleTitle(){this.replaceProperty({paths:"loading.sizeClassName",data:"loading--exclude_module_title"})},setLoadingExcludeSearchForm(){this.replaceProperty({paths:"loading.sizeClassName",data:"loading--exclude_search_form"})}}}},5897:function(e,t,s){s.d(t,{A:function(){return n}});var a=s(641),r=s(2644);function i(e,t,s,i,c,o){return(0,a.uX)(),(0,a.CE)("h4",{class:"module_title main_box_shadow",onClick:t[0]||(t[0]=t=>e.$emit("click",arguments[0]))},(0,r.v_)(e.title),1)}var c=(0,a.pM)({emits:["click"],name:"PubModuleTitle",props:{title:{type:String,default(){return""}}}}),o=s(6262);const h=(0,o.A)(c,[["render",i],["__scopeId","data-v-ac7e64d2"]]);var n=h},9256:function(e,t,s){s.r(t),s.d(t,{default:function(){return A}});var a=s(641),r=s(9322),i=s(2644);(0,a.Qi)("data-v-9a8b3bf6");const c={class:"search"},o={class:"search__cont",ref:"searchCont"},h=["placeholder"],n={class:"search__rec"},l={class:"search__type"},d={class:"search__list"},u=["onClick"],p={class:"search__res"},_={class:"search__count"};function m(e,t,s,m,S,w){const y=(0,a.g2)("PubModuleTitle"),k=(0,a.g2)("AppMusicList");return(0,a.uX)(),(0,a.CE)("section",c,[(0,a.bF)(y,{title:e.title,class:"search__title"},null,8,["title"]),(0,a.Lk)("div",o,[(0,a.Lk)("form",{class:"search__form",onSubmit:t[3]||(t[3]=(0,r.D$)(()=>{},["prevent"]))},[(0,a.bo)((0,a.Lk)("input",{type:"text",placeholder:e.placeholder,class:"search__input","onUpdate:modelValue":t[0]||(t[0]=t=>e.keyword=t),onKeyup:t[1]||(t[1]=(0,r.jR)((...t)=>e.getSearchRes&&e.getSearchRes(...t),["enter"]))},null,40,h),[[r.Jo,e.keyword,void 0,{trim:!0}]]),(0,a.Lk)("button",{class:(0,i.C4)(e.isSearchResShow?"search__btn search__btn--active":"search__btn"),type:"button",onClick:t[2]||(t[2]=(...t)=>e.getSearchRes&&e.getSearchRes(...t))},(0,i.v_)(e.title),3)],32),(0,a.bo)((0,a.Lk)("div",n,[(0,a.Lk)("h6",l,(0,i.v_)(e.searchType),1),(0,a.Lk)("ul",d,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.searchRecArr,(t,s)=>((0,a.uX)(),(0,a.CE)("li",{class:"search__item main_border_bottom",key:s,onClick:s=>{e.keyword=t.keyword,e.getSearchRes()}},(0,i.v_)(t.keyword),9,u))),128))])],512),[[r.aG,e.isSearchRecShow]]),(0,a.bo)((0,a.Lk)("div",p,[(0,a.Lk)("div",_,"共有"+(0,i.v_)(e.searchRes.info.length)+"条结果",1),(0,a.bF)(k,{"music-list":e.searchRes.info,class:"search__res-list"},null,8,["music-list"])],512),[[r.aG,e.isSearchResShow]])],512)])}(0,a.jt)();var S=s(5897),w=s(1719),y=s(9023),k=s(5984);const g=({params:e={}}={})=>(0,k.A)({...y.G,params:{format:"json",plat:0,count:30,...e}}),v=({params:e={}}={})=>(0,k.A)({...y.O,params:{format:"json",page:1,pagesize:20,showtype:1,...e}});var R=s(2122),f=s(5382),L=s(6278),C=(0,a.pM)({name:"Search",mixins:[f.A],components:{PubModuleTitle:S.A,AppMusicList:w.A},data(){return{title:"搜索",searchType:"最近热门",placeholder:"歌手/歌名/拼音"}},computed:{...(0,L.aH)("search",["searchRecArr","searchRes","isSearchRecShow","isSearchResShow"]),keyword:{get(){return this.$store.state.search.keyword},set(e){this.replaceProperty({paths:"search.keyword",data:e})}},isSearchRecShow:{get(){return this.$store.state.search.isSearchRecShow},set(e){this.replaceProperty({paths:"search.isSearchRecShow",data:e})}},isSearchResShow:{get(){return this.$store.state.search.isSearchResShow},set(e){this.replaceProperty({paths:"search.isSearchResShow",data:e})}}},created(){this.init()},mounted(){R.A.$on("searchBtnClicked",this.scrollTopSearchCont),this.initQqBugDetect()},unmounted(){R.A.$off("searchBtnClicked",this.scrollTopSearchCont)},methods:{...(0,L.PY)(["replaceProperty"]),init(){let e=this.$route.query.keyword,t="string"===typeof this.keyword&&""!==this.keyword,s="string"===typeof e&&""!==e;s&&e!==this.keyword?(this.keyword=e,this.getSearchRes()):t?(this.isSearchRecShow=!1,this.isSearchResShow=!0):this.getSearchRec()},getSearchRec(){if(0!==this.searchRecArr.length)return this.isSearchResShow=!1,void(this.isSearchRecShow=!0);this.setLoadingExcludeSearchForm(),this.startLoading(),g().then(({data:e})=>{this.replaceProperty({paths:"search.searchRecArr",data:e.data.info}),this.stopLoading(),this.isSearchResShow=!1,this.isSearchRecShow=!0}).catch(e=>{alert(e)})},getSearchRes(){""!==this.keyword&&(this.$router.replace({query:{keyword:this.keyword}}),this.setLoadingExcludeSearchForm(),this.startLoading(),v({params:{keyword:this.keyword}}).then(e=>{let t=e.data.data;this.replaceProperty({paths:"search.searchRes",data:t}),this.isSearchRecShow=!1,this.isSearchResShow=!0,this.stopLoading()}))},initQqBugDetect(){let e=document.getElementsByClassName("search__cont")[0];window.search__cont=e;
//! bug with qq browser
let t=function(){e.scrollTop};window.addEventListener("touchstart",t),window.addEventListener("touchmove",t)},scrollTopSearchCont(){this.$refs.searchCont&&(this.$refs.searchCont.scrollTop=0)}}}),b=s(6262);const P=(0,b.A)(C,[["render",m],["__scopeId","data-v-9a8b3bf6"]]);var A=P}}]);
//# sourceMappingURL=Search.f9024e2a.js.map