"use strict";(self["webpackChunkkugou"]=self["webpackChunkkugou"]||[]).push([[522],{831:function(e,t,r){r.r(t),r.d(t,{default:function(){return x}});var i=r(6913);(0,i.Qi)("data-v-a53cc1da");var n={key:0,class:"player"},s={class:"player__cont"},a={class:"player__song_name"},o=["src"],c={class:"player__buttons"},u=(0,i.Lk)("button",{class:"player__download"},null,-1);function l(e,t,r,l,d,h){var p=(0,i.g2)("PlayerLyrics"),m=(0,i.g2)("PlayerProgress"),g=(0,i.g2)("PrevButton"),y=(0,i.g2)("PlayButton"),f=(0,i.g2)("NextButton");return e.music?((0,i.uX)(),(0,i.CE)("section",n,[(0,i.Lk)("div",{class:"player__mask",style:(0,i.Tr)(e.playerBgImg)},null,4),(0,i.Lk)("div",s,[(0,i.Lk)("h6",a,(0,i.v_)(e.songName),1),(0,i.Lk)("img",{src:e.singerImg,class:(0,i.C4)(e.isPlaying?"player__singer_img player__singer_img--active":"player__singer_img")},null,10,o),(0,i.bF)(p,{class:"player__lyrics"}),(0,i.bF)(m,{class:"player__progress"}),(0,i.Lk)("div",c,[(0,i.bF)(g,{class:"player__btn_prev"}),(0,i.bF)(y,{class:"player__btn_status"}),(0,i.bF)(f,{class:"play__btn_next"})]),u])])):(0,i.Q3)("",!0)}(0,i.jt)();var d=r(1034);r(7495),r(5440);function h(e,t,r,n,s,a){return(0,i.uX)(),(0,i.CE)("div",{class:"player_lyric",onTouchstart:t[0]||(t[0]=function(t){return e.isTouching=!0}),onTouchend:t[1]||(t[1]=function(t){return e.isTouching=!1})},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.lyricItems,function(t,r){return(0,i.uX)(),(0,i.CE)("p",(0,i.v6)(e.getVBindObj("millisecond-"+t.millisecond),{key:t.millisecond,ref:function(r){return e.lyricElements[t.millisecond]=r},class:r===e.prevLyricIndex+1?"player_lyric_text player_lyric_text--active ":"player_lyric_text"}),(0,i.v_)(t.text),17)}),128))],32)}r(8980),r(2062),r(8111),r(1701),r(6099);var p=r(6278),m=r(1981),g=(0,i.pM)({name:"PlayerLyrics",data:function(){return{getVBindObj:m.Zy,prevLyricIndex:0,isTouching:!1,lyricElements:[]}},computed:(0,d.A)((0,d.A)((0,d.A)({},(0,p.aH)("player",["audioEl"])),(0,p.L8)("player",["lyricItems"])),{},{lyricMillisecond:function(){return this.lyricItems.map(function(e){return e.millisecond})}}),watch:{lyricItems:{handler:function(e){0!==e.length&&(this.lyricElements=e.map(function(){return null}))},immediate:!0,deep:!0}},mounted:function(){var e=this;(0,i.dY)(function(){e.audioEl.addEventListener("timeupdate",e.timeUpdateCb)})},unmounted:function(){this.audioEl.removeEventListener("timeupdate",this.timeUpdateCb)},methods:{timeUpdateCb:function(e){if(!this.isTouching){var t=Math.floor(1e3*e.target.currentTime),r=this.lyricMillisecond.findIndex(function(e){return e>1.005*t}),i=r>1?r-2:0,n=this.$refs&&this.$refs[this.lyricMillisecond[i]];n&&this.$refs[this.lyricMillisecond[i]][0].scrollIntoView(),this.prevLyricIndex=i}}}}),y=r(6262);const f=(0,y.A)(g,[["render",h],["__scopeId","data-v-184f50a4"]]);var _=f;(0,i.Qi)("data-v-b7d87cd8");var v={class:"player_progress__song_cur_time"},E={class:"player_progress__song_duration"};function b(e,t,r,n,s,a){return(0,i.uX)(),(0,i.CE)("div",{class:"player_progress",onTouchstart:t[0]||(t[0]=function(){return e.setCurTime&&e.setCurTime.apply(e,arguments)})},[(0,i.Lk)("div",v,(0,i.v_)(e.secondToMin(e.currentTime)),1),(0,i.Lk)("div",{class:"player_progress__progress_bar",ref:"progressBar",style:(0,i.Tr)(e.progressBarStyle)},[(0,i.Lk)("div",{class:"player_progress__progress_bar_pointer",style:(0,i.Tr)("left:".concat(e.currentProgress,"%;"))},null,4)],4),(0,i.Lk)("div",E,(0,i.v_)(e.secondToMin(e.audioEl.duration)),1)],32)}(0,i.jt)();r(8706);var T=(0,i.pM)({name:"PlayerProgress",data:function(){return{secondToMin:m.Yn,currentTime:0,loadProgress:0,isTouching:!1,touchStartX:0,progressBarRect:null}},computed:(0,d.A)((0,d.A)({},(0,p.aH)("player",["song","audioEl"])),{},{currentProgress:function(){return Math.floor(100*this.currentTime/this.audioEl.duration)},progressBarStyle:function(){return"background-image:linear-gradient(to right, #2ca2f9 ".concat(this.currentProgress,"%, transparent ").concat(this.currentProgress,"%),linear-gradient(to right, #6c6b70 ").concat(this.loadProgress,"%, transparent ").concat(this.loadProgress,"%)")}}),mounted:function(){var e=this;(0,i.dY)(function(){e.audioEl.addEventListener("progress",e.progressCb),e.audioEl.addEventListener("timeupdate",e.timeUpdateCb)})},unmounted:function(){this.audioEl.removeEventListener("progress",this.progressCb),this.audioEl.removeEventListener("timeupdate",this.timeUpdateCb)},methods:{progressCb:function(){if(!(this.audioEl.readyState<2)){var e=this.audioEl.buffered.length;this.loadProgress=Math.floor(100*this.audioEl.buffered.end(e-1)/this.audioEl.duration)}},timeUpdateCb:function(e){this.isTouching||(this.currentTime=e.target.currentTime)},setCurTime:function(e){this.isTouching=!0,this.progressBarRect||(this.progressBarRect=this.$refs.progressBar.getBoundingClientRect());var t=e.touches[0].clientX;this.currentTime=this.calcCurTime(t,this.progressBarRect.left,0),this.touchStartX=t,window.addEventListener("touchmove",this.setCurTimeOnMove),window.addEventListener("touchend",this.touchEndCb)},setCurTimeOnMove:function(e){var t=e.touches[0].clientX;this.currentTime=this.calcCurTime(t,this.touchStartX,1),this.touchStartX=t},touchEndCb:function(){this.isTouching=!1,this.audioEl.currentTime=this.currentTime,window.removeEventListener("touchmove",this.setCurTimeOnMove),window.removeEventListener("touchend",this.touchEndCb)},calcCurTime:function(e,t,r){var i,n=e-t,s=n/this.progressBarRect.width;switch(r){case 0:i=this.audioEl.duration*s;break;case 1:i=this.currentTime+this.audioEl.duration*s;break}return i<0?i=0:i>this.audioEl.duration&&(i=this.audioEl.duration),i}}});const P=(0,y.A)(T,[["render",b],["__scopeId","data-v-b7d87cd8"]]);var C=P,L=r(7288),k=r(8350),B=r(8270),M=r(7757),w=r(6204),A=(0,i.pM)({name:"PlayerMax",components:{PlayerLyrics:_,PlayerProgress:C,PlayButton:L.A,NextButton:k.A,PrevButton:B.A},computed:(0,d.A)((0,d.A)((0,d.A)((0,d.A)({},(0,p.aH)("images",["logo__theme"])),(0,p.aH)("player",["audioEl","isPlaying","song","music"])),(0,p.L8)("player",["songName","singerName","singerImg"])),{},{playerBgImg:function(){return"background-image:url(".concat(this.singerImg,"),linear-gradient(to right, rgb(48, 67, 82), rgb(215, 210, 204));")}}),watch:{"music.hash":function(e){this.$router.replace({query:{musicHash:e}})}},beforeRouteEnter:function(e,t,r){var i=e.query.musicHash;if(i)return e.meta.fromPlayerMed?r():(0,M.B)({params:{hash:i}}).then(function(e){var t=e.data.data;t.filename=t.audio_name,w.A.commit("player/wantPlay",{music:t,musicList:[t]}),w.A.commit("player/wantPlay",{music:t,musicList:[t]}),r()})},mounted:function(){this.replaceProperty({paths:"player.isPlayerMedShow",data:!1})},unmounted:function(){this.replaceProperty({paths:"player.isPlayerMedShow",data:!0}),this.replaceProperty({paths:"player.isPlayerMedSmall",data:!1})},methods:(0,d.A)({},(0,p.PY)(["replaceProperty"]))});const I=(0,y.A)(A,[["render",l],["__scopeId","data-v-a53cc1da"]]);var x=I},8706:function(e,t,r){var i=r(6518),n=r(9039),s=r(4376),a=r(34),o=r(8981),c=r(6198),u=r(6837),l=r(4659),d=r(1469),h=r(597),p=r(8227),m=r(9519),g=p("isConcatSpreadable"),y=m>=51||!n(function(){var e=[];return e[g]=!1,e.concat()[0]!==e}),f=function(e){if(!a(e))return!1;var t=e[g];return void 0!==t?!!t:s(e)},_=!y||!h("concat");i({target:"Array",proto:!0,arity:1,forced:_},{concat:function(e){var t,r,i,n,s,a=o(this),h=d(a,0),p=0;for(t=-1,i=arguments.length;t<i;t++)if(s=-1===t?a:arguments[t],f(s))for(n=c(s),u(p+n),r=0;r<n;r++,p++)r in s&&l(h,p,s[r]);else u(p+1),l(h,p++,s);return h.length=p,h}})}}]);
//# sourceMappingURL=PlayerMax-legacy.f5eefbcd.js.map