System.register(["./index-legacy-CmJ-z1qb.js","./PubModuleTitle-legacy-9MNiQtRj.js","./AppMusicList-legacy-CtGdxpaR.js","./useLoading-legacy-Bk4mozhw.js"],function(e,a){"use strict";var t,c,r,s,o,l,v,n,i,d,h,u,w,_,f,p,m,g,b,y,k,x,S,C,L,z,E,R,j,P;return{setters:[e=>{t=e.K,c=e.g,r=e.h,s=e.d,o=e.l,l=e.r,v=e.i,n=e.u,i=e.G,d=e.H,h=e.o,u=e.s,w=e.I,_=e.c,f=e.j,p=e.b,m=e.C,g=e.a,b=e.J,y=e.L,k=e.y,x=e.t,S=e.D,C=e.F,L=e.e,z=e.f,E=e._},e=>{R=e.P},e=>{j=e.A},e=>{P=e.u}],execute:function(){var a=document.createElement("style");a.textContent=".search[data-v-3e813df0]{box-sizing:border-box}.search__cont[data-v-3e813df0]{overflow:scroll;box-sizing:border-box;height:calc(100% - calc(var(--vw, 1vw) * 14.4))}.search__form[data-v-3e813df0]{box-sizing:border-box;height:calc(var(--vw, 1vw) * 16.8);padding:calc(var(--vw, 1vw) * 3.46667);background-color:#fbfbfb}.search__input[data-v-3e813df0],.search__btn[data-v-3e813df0]{box-sizing:border-box;height:100%;border-radius:calc(var(--vw, 1vw) * 1.33333)}.search__input[data-v-3e813df0]{width:calc(var(--vw, 1vw) * 73.86667);margin-right:calc(var(--vw, 1vw) * 2.66667);padding:calc(var(--vw, 1vw) * 1.86667) 1px calc(var(--vw, 1vw) * 1.86667) calc(var(--vw, 1vw) * 8.26667);border:1px solid #e5e5e5;background-color:#fff}.search__btn[data-v-3e813df0]{width:calc(var(--vw, 1vw) * 16);color:#959595;background-color:#e5e5e5}.search__btn--active[data-v-3e813df0]{color:#fff;background:#2ca2f9}.search__type[data-v-3e813df0]{height:calc(var(--vw, 1vw) * 13.6);padding-left:calc(var(--vw, 1vw) * 4.26667);color:#2ca2f9;border-bottom:1px solid #ccc;font-size:calc(var(--vw, 1vw) * 4.26667);line-height:calc(var(--vw, 1vw) * 13.6)}.search__item[data-v-3e813df0]{height:calc(var(--vw, 1vw) * 17.06667);margin-left:calc(var(--vw, 1vw) * 4.26667);font-size:calc(var(--vw, 1vw) * 5.33333);line-height:calc(var(--vw, 1vw) * 17.06667)}.search__count[data-v-3e813df0]{box-sizing:border-box;width:100%;padding-left:calc(var(--vw, 1vw) * 4.26667);color:#959595;background-color:#e5e5e5;font-size:calc(var(--vw, 1vw) * 3.73333);line-height:calc(var(--vw, 1vw) * 7.46667)}.search__res-list[data-v-3e813df0]{overflow-y:scroll}\n/*$vite$:1*/",document.head.appendChild(a);const T={method:"GET",url:t+"/api/v3/search/song"},A=c({method:"GET",url:t+"/api/v3/search/hot"},"hotSearch"),$=c(T,"keywordSearch");function B(e){return e.data.info}const G={class:"search"},q=["placeholder"],F={class:"search__rec"},I={class:"search__type"},K={class:"search__list"},M=["onClick"],D={class:"search__res"},H={class:"search__count"};e("default",E(s({__name:"Search",setup(e){const a=n(),t=u(),c=w(),{startLoading:s,stopLoading:E,setLoadingExcludeSearchForm:T}=P(),J=o("searchCont"),N=l("搜索"),U=l("最近热门"),V=l("歌手/歌名/拼音"),O=v(()=>a.state.search.searchRecArr),Q=v(()=>a.state.search.searchRes),W=v({get:()=>a.state.search.keyword,set(e){a.commit("replaceProperty",{paths:"search.keyword",data:e})}}),X=v({get:()=>a.state.search.isSearchRecShow,set(e){a.commit("replaceProperty",{paths:"search.isSearchRecShow",data:e})}}),Y=v({get:()=>a.state.search.isSearchResShow,set(e){a.commit("replaceProperty",{paths:"search.isSearchResShow",data:e})}});function Z(){""!==W.value&&(c.replace({query:{keyword:W.value}}),T(),s(),(({params:e={}}={})=>r({...$,params:{format:"json",page:1,pagesize:20,showtype:1,...e}}))({params:{keyword:W.value}}).then(e=>{var t;a.commit("replaceProperty",{paths:"search.searchRes",data:(t=e.data,t.data)}),X.value=!1,Y.value=!0,E()}))}function ee(){const e=document.getElementsByClassName("search__cont")[0];if(e){window.search__cont=e;//! bug with qq browser
const a=function(){e.scrollTop};window.addEventListener("touchstart",a),window.addEventListener("touchmove",a)}}function ae(){J.value&&(J.value.scrollTop=0)}return function(){const e=t.query.keyword,c="string"==typeof W.value&&""!==W.value;"string"==typeof e&&""!==e&&e!==W.value?(W.value=e,Z()):c?(X.value=!1,Y.value=!0):function(){if(0!==O.value.length)return Y.value=!1,void(X.value=!0);T(),s(),(({params:e={}}={})=>r({...A,params:{format:"json",plat:0,count:30,...e}}))().then(({data:e})=>{a.commit("replaceProperty",{paths:"search.searchRecArr",data:B(e)}),E(),Y.value=!1,X.value=!0}).catch(e=>{alert(e)})}()}(),i(()=>{ee(),d.$on("searchBtnClicked",ae)}),h(()=>{window.removeEventListener("touchstart",ee),window.removeEventListener("touchmove",ee),d.$off("searchBtnClicked",ae)}),(e,a)=>(z(),_("section",G,[f(R,{title:N.value,class:"search__title"},null,8,["title"]),p("div",{class:"search__cont",ref_key:"searchCont",ref:J},[p("form",{class:"search__form",onSubmit:a[1]||(a[1]=g(()=>{},["prevent"]))},[m(p("input",{type:"text",placeholder:V.value,class:"search__input","onUpdate:modelValue":a[0]||(a[0]=e=>W.value=e),onKeyup:y(Z,["enter"])},null,40,q),[[b,W.value,void 0,{trim:!0}]]),p("button",{class:k(Y.value?"search__btn search__btn--active":"search__btn"),type:"button",onClick:Z},x(N.value),3)],32),m(p("div",F,[p("h6",I,x(U.value),1),p("ul",K,[(z(!0),_(C,null,L(O.value,(e,a)=>(z(),_("li",{class:"search__item main_border_bottom",key:a,onClick:a=>{W.value=e.keyword,Z()}},x(e.keyword),9,M))),128))])],512),[[S,X.value]]),m(p("div",D,[p("div",H,"共有"+x(Q.value.info.length)+"条结果",1),f(j,{"music-list":Q.value.info,class:"search__res-list"},null,8,["music-list"])],512),[[S,Y.value]])],512)]))}}),[["__scopeId","data-v-3e813df0"]]))}}});
