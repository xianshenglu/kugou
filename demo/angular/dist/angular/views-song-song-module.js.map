{"version":3,"sources":["./src/app/views/song/song-routing.module.ts","./src/app/services/song-list.service.ts","./src/app/views/song/song-list/song-list.component.html","./src/app/views/song/song-list/song-list.component.ts","./src/app/views/song/song-list-info/song-list-info.component.ts","./src/app/views/song/song-list-info/song-list-info.component.html","./src/app/services/song-list-info.service.ts","./src/app/views/song/song.module.ts"],"names":[],"mappings":"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","file":"views-song-song-module.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { SongListComponent } from './song-list/song-list.component';\r\nimport { SongListInfoComponent } from './song-list-info/song-list-info.component';\r\nimport { MyMainComponent } from '../../components/my-main/my-main.component';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: 'list',\r\n    component: MyMainComponent,\r\n    children: [\r\n      {\r\n        path: '',\r\n        component: SongListComponent,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    path: 'list/:songListId',\r\n    component: SongListInfoComponent,\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class SongRoutingModule {}\r\n","import { BASE_ORIGIN } from 'src/app/constants/index';\r\nimport { replaceSizeInUrl } from 'src/app/utils';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\n\r\ntype SongItem = {\r\n  imgurl: string;\r\n  imgUrl: string;\r\n  specialid: number;\r\n  path: string;\r\n  specialname: string;\r\n  title: string;\r\n  playcount: number;\r\n  popularity: number;\r\n};\r\n\r\ntype SongListResponse = {\r\n  plist: {\r\n    list: {\r\n      info: SongItem[];\r\n    };\r\n  };\r\n};\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class SongListService {\r\n  songListUrl = `${BASE_ORIGIN}/plist/index&json=true`;\r\n\r\n  constructor(private http: HttpClient) {}\r\n\r\n  async fetchSongList() {\r\n    const response = await this.http\r\n      .get<SongListResponse>(this.songListUrl)\r\n      .toPromise();\r\n    const {\r\n      plist: {\r\n        list: { info },\r\n      },\r\n    } = response;\r\n    info.forEach((obj) => {\r\n      obj.imgUrl = replaceSizeInUrl(obj.imgurl);\r\n      obj.path = `/song/list/${obj.specialid}`;\r\n      obj.title = obj.specialname;\r\n      obj.popularity = obj.playcount;\r\n    });\r\n    return info;\r\n  }\r\n}\r\n","<section class=\"song_list\" test-id=\"page-song-list\">\r\n  <app-my-card-list [pubList]=\"songList\" class=\"song_list__cont\">\r\n    <ng-template let-item>\r\n      <div class=\"song_list__info\">\r\n        <div class=\"song_list__title\">{{ item.title }}</div>\r\n        <div class=\"song_list__star\">\r\n          <svg class=\"icon song_list__icon\" aria-hidden=\"true\">\r\n            <use xlink:href=\"#icon-music\"></use>\r\n          </svg>\r\n          <span class=\"song_list__popularity\">{{ item.popularity }}</span>\r\n        </div>\r\n      </div>\r\n    </ng-template>\r\n  </app-my-card-list>\r\n</section>\r\n","import { ResponseTypeFromServiceReq } from 'src/app/typings/index';\r\nimport { SongListService } from 'src/app/services/song-list.service';\r\nimport { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-song-list',\r\n  templateUrl: './song-list.component.html',\r\n  styleUrls: ['./song-list.component.scss'],\r\n})\r\nexport class SongListComponent implements OnInit {\r\n  songList: ResponseTypeFromServiceReq<\r\n    typeof SongListService,\r\n    'fetchSongList'\r\n  > = [];\r\n\r\n  constructor(private songListService: SongListService) {}\r\n\r\n  async ngOnInit(): Promise<void> {\r\n    if (this.songList.length === 0) {\r\n      this.songList = await this.songListService.fetchSongList();\r\n    }\r\n  }\r\n}\r\n","import { ResponseTypeFromServiceReq } from 'src/app/typings/index';\r\nimport { SongListInfoService } from 'src/app/services/song-list-info.service';\r\nimport { replaceSizeInUrl } from 'src/app/utils';\r\nimport { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-song-list-info',\r\n  templateUrl: './song-list-info.component.html',\r\n  styleUrls: ['./song-list-info.component.scss'],\r\n})\r\nexport class SongListInfoComponent implements OnInit {\r\n  songListInfo: ResponseTypeFromServiceReq<\r\n    typeof SongListInfoService,\r\n    'fetchSongListInfo'\r\n  > = { info: { list: {}, songs: { list: { info: [] } } } };\r\n\r\n  constructor(private songListInfoService: SongListInfoService) {}\r\n\r\n  get getModuleHeadInfo() {\r\n    /* eslint-disable */\r\n    // @ts-ignore\r\n    const data = this.songListInfo.info.list;\r\n    return {\r\n      imgUrl: replaceSizeInUrl(data.imgurl),\r\n      name: data.specialname,\r\n      intro: data.intro,\r\n    };\r\n    /* eslint-enable */\r\n  }\r\n\r\n  get getMusicList() {\r\n    // todo remove ? and fix type\r\n    // @ts-ignore\r\n    // eslint-disable-next-line\r\n    return this.songListInfo.songs?.list.info;\r\n  }\r\n\r\n  async ngOnInit(): Promise<void> {\r\n    const songListId = window.location.pathname.split('/').pop();\r\n    if (songListId === undefined) {\r\n      return;\r\n    }\r\n    this.songListInfo = await this.songListInfoService.fetchSongListInfo(\r\n      songListId\r\n    );\r\n  }\r\n}\r\n","<section class=\"song_list_info\" test-id=\"page-song-list-info\">\r\n  <app-my-module-head [moduleHeadInfo]=\"getModuleHeadInfo\">\r\n    <app-my-module-description\r\n      slot=\"moduleDes\"\r\n      [description]=\"getModuleHeadInfo.intro\"\r\n    >\r\n    </app-my-module-description>\r\n  </app-my-module-head>\r\n  <app-my-music-list [musicList]=\"getMusicList\"> </app-my-music-list>\r\n</section>\r\n","import { BASE_ORIGIN } from 'src/app/constants';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\n\r\ntype SongListInfoResponse = {\r\n  info: {\r\n    list: {\r\n      imgurl: string;\r\n      specialname: string;\r\n      intro: string;\r\n    };\r\n  };\r\n  list: { list: { info: [] } };\r\n};\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class SongListInfoService {\r\n  constructor(private http: HttpClient) {}\r\n\r\n  async fetchSongListInfo(songListId: string) {\r\n    const response = await this.http\r\n      .get<SongListInfoResponse>(\r\n        `${BASE_ORIGIN}/plist/list/${songListId}&json=true`\r\n      )\r\n      .toPromise();\r\n    const { info, list } = response;\r\n    return {\r\n      info,\r\n      songs: list,\r\n    };\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { SongListComponent } from './song-list/song-list.component';\r\nimport { SongListInfoComponent } from './song-list-info/song-list-info.component';\r\nimport { SongRoutingModule } from './song-routing.module';\r\nimport { SharedModule } from '../../shared/shared.module';\r\n\r\n@NgModule({\r\n  declarations: [SongListComponent, SongListInfoComponent],\r\n  imports: [CommonModule, SharedModule, SongRoutingModule],\r\n})\r\nexport class SongModule {}\r\n"],"sourceRoot":"webpack:///"}