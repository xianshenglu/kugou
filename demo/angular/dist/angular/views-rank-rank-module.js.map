{"version":3,"sources":["./src/app/views/rank/rank.module.ts","./src/app/views/rank/rank-list/rank-list.component.html","./src/app/views/rank/rank-list/rank-list.component.ts","./src/app/services/rank-info.service.ts","./src/app/views/rank/rank-info/rank-info.component.ts","./src/app/views/rank/rank-info/rank-info.component.html","./src/app/services/rank-list.service.ts","./src/app/views/rank/rank-routing.module.ts"],"names":[],"mappings":"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","file":"views-rank-rank-module.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RankListComponent } from './rank-list/rank-list.component';\nimport { RankInfoComponent } from './rank-info/rank-info.component';\nimport { RankRoutingModule } from './rank-routing.module';\nimport { SharedModule } from '../../shared/shared.module';\n\n@NgModule({\n  declarations: [RankListComponent, RankInfoComponent],\n  imports: [CommonModule, SharedModule, RankRoutingModule],\n})\nexport class RankModule {}\n","<section class=\"rank_list\" test-id=\"page-rank-list\">\n  <app-my-card-list [pubList]=\"rankList\" class=\"rank_list__cont\">\n    <ng-template class=\"rank_list__info\" let-item>\n      <div class=\"rank_list__info\">{{ item.title }}</div>\n    </ng-template>\n  </app-my-card-list>\n</section>\n","import { ResponseTypeFromServiceReq } from 'src/app/typings/index';\nimport { RankListService } from 'src/app/services/rank-list.service';\nimport { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-rank-list',\n  templateUrl: './rank-list.component.html',\n  styleUrls: ['./rank-list.component.scss'],\n})\nexport class RankListComponent implements OnInit {\n  rankList: ResponseTypeFromServiceReq<\n    typeof RankListService,\n    'fetchRankList'\n  > = [];\n\n  constructor(private rankListService: RankListService) {}\n\n  async ngOnInit(): Promise<void> {\n    if (this.rankList.length === 0) {\n      this.rankList = await this.rankListService.fetchRankList();\n    }\n  }\n}\n","import { BASE_ORIGIN } from 'src/app/constants';\nimport { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\n\nexport type RankInfoResponse = {\n  info: {\n    banner7url: string;\n    rankname: string;\n  };\n  songs: {\n    list: { index: number }[];\n    timestamp: number;\n  };\n};\n@Injectable({\n  providedIn: 'root',\n})\nexport class RankInfoService {\n  rankInfoUrl = `${BASE_ORIGIN}/rank/info/&json=true&page=1&rankid=`;\n\n  constructor(private http: HttpClient) {}\n\n  async fetchRankInfo(rankId: string) {\n    console.log(122, rankId);\n    const response = await this.http\n      .get<RankInfoResponse>(this.rankInfoUrl + rankId)\n      .toPromise();\n    response.songs.list.forEach((obj, index) => {\n      obj.index = index;\n    });\n    console.log(12345, response);\n    return response;\n  }\n}\n","import { replaceSizeInUrl } from 'src/app/utils';\nimport { ResponseTypeFromServiceReq } from 'src/app/typings/index';\nimport { RankInfoService } from 'src/app/services/rank-info.service';\nimport { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-rank-info',\n  templateUrl: './rank-info.component.html',\n  styleUrls: ['./rank-info.component.scss'],\n})\nexport class RankInfoComponent implements OnInit {\n  msg = '上次更新时间';\n\n  rankInfo: ResponseTypeFromServiceReq<\n    typeof RankInfoService,\n    'fetchRankInfo'\n  > = { info: {}, songs: { list: {}, timestamp: 0 } };\n\n  constructor(private rankInfoService: RankInfoService) {}\n\n  get getModuleHeadInfo() {\n    return {\n      // @ts-ignore\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n      imgUrl: replaceSizeInUrl(this.rankInfo.info.banner7url),\n      // @ts-ignore\n\n      // eslint-disable-next-line\n      name: this.rankInfo.info.rankname,\n    };\n  }\n\n  get getMusicList() {\n    // @ts-ignore\n    // eslint-disable-next-line\n    return this.rankInfo.songs.list;\n  }\n\n  get formatDate() {\n    // @ts-ignore\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    const date = new Date(this.rankInfo.songs.timestamp * 1000);\n    return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(\n      2,\n      '0'\n    )}-${String(date.getDate()).padStart(2, '0')}`;\n  }\n\n  async ngOnInit(): Promise<void> {\n    const rankId = window.location.pathname.split('/').pop();\n    if (rankId === undefined) {\n      return;\n    }\n    this.rankInfo = await this.rankInfoService.fetchRankInfo(rankId);\n  }\n}\n","<section class=\"rank_info\" test-id=\"page-rank-info\">\n  <app-my-module-head [moduleHeadInfo]=\"getModuleHeadInfo\">\n    <ng-template>\n      <time class=\"rank_info__update_time\" slot=\"moduleUpdateTime\"\n        >{{ msg }} {{ formatDate }}</time\n      >\n    </ng-template>\n  </app-my-module-head>\n  <app-my-music-list [musicList]=\"getMusicList\">\n    <ng-template let-music>\n      <div\n        slot=\"default\"\n        [class]=\"['rank_info__index', 'rank_info__index' + (music.index + 1)]\"\n      >\n        {{ music.index + 1 }}\n      </div>\n    </ng-template>\n  </app-my-music-list>\n</section>\n","import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { BASE_ORIGIN } from 'src/app/constants';\nimport { replaceSizeInUrl } from '../utils';\n\ntype RankItem = {\n  imgurl: string;\n  rankid: string;\n  rankname: string;\n  imgUrl: string;\n  path: string;\n  title: string;\n};\nexport type RankListResponse = {\n  rank: {\n    list: RankItem[];\n  };\n};\n@Injectable({\n  providedIn: 'root',\n})\nexport class RankListService {\n  rankListUrl = `${BASE_ORIGIN}/rank/list&json=true`;\n\n  constructor(private http: HttpClient) {}\n\n  async fetchRankList(params = {}): Promise<RankItem[]> {\n    const response = await this.http\n      .get<RankListResponse>(this.rankListUrl, {\n        params: { ...params },\n        observe: 'body',\n        responseType: 'json',\n      })\n      .toPromise();\n    response.rank.list.forEach((obj) => {\n      obj.imgUrl = replaceSizeInUrl(obj.imgurl);\n      obj.path = `/rank/info/${obj.rankid}`;\n      obj.title = obj.rankname;\n    });\n    return response.rank.list;\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { RankListComponent } from './rank-list/rank-list.component';\nimport { RankInfoComponent } from './rank-info/rank-info.component';\nimport { MyMainComponent } from '../../components/my-main/my-main.component';\n\nconst routes: Routes = [\n  {\n    path: 'list',\n    component: MyMainComponent,\n    children: [\n      {\n        path: '',\n        component: RankListComponent,\n      },\n    ],\n  },\n  {\n    path: 'info/:rankId',\n    component: RankInfoComponent,\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class RankRoutingModule {}\n"],"sourceRoot":"webpack:///"}