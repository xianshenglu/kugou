{"version":3,"sources":["./src/app/views/rank/rank.module.ts","./src/app/views/rank/rank-list/rank-list.component.html","./src/app/views/rank/rank-list/rank-list.component.ts","./src/app/services/rank-info.service.ts","./src/app/views/rank/rank-info/rank-info.component.ts","./src/app/views/rank/rank-info/rank-info.component.html","./src/app/services/rank-list.service.ts","./src/app/views/rank/rank-routing.module.ts"],"names":[],"mappings":"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","file":"views-rank-rank-module.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { RankListComponent } from './rank-list/rank-list.component';\r\nimport { RankInfoComponent } from './rank-info/rank-info.component';\r\nimport { RankRoutingModule } from './rank-routing.module';\r\nimport { SharedModule } from '../../shared/shared.module';\r\n\r\n@NgModule({\r\n  declarations: [RankListComponent, RankInfoComponent],\r\n  imports: [CommonModule, SharedModule, RankRoutingModule],\r\n})\r\nexport class RankModule {}\r\n","<section class=\"rank_list\" test-id=\"page-rank-list\">\r\n  <app-my-card-list [pubList]=\"rankList\" class=\"rank_list__cont\">\r\n    <ng-template class=\"rank_list__info\" let-item>\r\n      <div class=\"rank_list__info\">{{ item.title }}</div>\r\n    </ng-template>\r\n  </app-my-card-list>\r\n</section>\r\n","import { ResponseTypeFromServiceReq } from 'src/app/typings/index';\r\nimport { RankListService } from 'src/app/services/rank-list.service';\r\nimport { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-rank-list',\r\n  templateUrl: './rank-list.component.html',\r\n  styleUrls: ['./rank-list.component.scss'],\r\n})\r\nexport class RankListComponent implements OnInit {\r\n  rankList: ResponseTypeFromServiceReq<\r\n    typeof RankListService,\r\n    'fetchRankList'\r\n  > = [];\r\n\r\n  constructor(private rankListService: RankListService) {}\r\n\r\n  async ngOnInit(): Promise<void> {\r\n    if (this.rankList.length === 0) {\r\n      this.rankList = await this.rankListService.fetchRankList();\r\n    }\r\n  }\r\n}\r\n","import { BASE_ORIGIN } from 'src/app/constants';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\n\r\nexport type RankInfoResponse = {\r\n  info: {\r\n    banner7url: string;\r\n    rankname: string;\r\n  };\r\n  songs: {\r\n    list: { index: number }[];\r\n    timestamp: number;\r\n  };\r\n};\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class RankInfoService {\r\n  rankInfoUrl = `${BASE_ORIGIN}/rank/info/&json=true&page=1&rankid=`;\r\n\r\n  constructor(private http: HttpClient) {}\r\n\r\n  async fetchRankInfo(rankId: string) {\r\n    console.log(122, rankId);\r\n    const response = await this.http\r\n      .get<RankInfoResponse>(this.rankInfoUrl + rankId)\r\n      .toPromise();\r\n    response.songs.list.forEach((obj, index) => {\r\n      obj.index = index;\r\n    });\r\n    console.log(12345, response);\r\n    return response;\r\n  }\r\n}\r\n","import { replaceSizeInUrl } from 'src/app/utils';\r\nimport { ResponseTypeFromServiceReq } from 'src/app/typings/index';\r\nimport { RankInfoService } from 'src/app/services/rank-info.service';\r\nimport { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-rank-info',\r\n  templateUrl: './rank-info.component.html',\r\n  styleUrls: ['./rank-info.component.scss'],\r\n})\r\nexport class RankInfoComponent implements OnInit {\r\n  msg = '上次更新时间';\r\n\r\n  rankInfo: ResponseTypeFromServiceReq<\r\n    typeof RankInfoService,\r\n    'fetchRankInfo'\r\n  > = { info: {}, songs: { list: {}, timestamp: 0 } };\r\n\r\n  constructor(private rankInfoService: RankInfoService) {}\r\n\r\n  get getModuleHeadInfo() {\r\n    return {\r\n      // @ts-ignore\r\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\r\n      imgUrl: replaceSizeInUrl(this.rankInfo.info.banner7url),\r\n      // @ts-ignore\r\n\r\n      // eslint-disable-next-line\r\n      name: this.rankInfo.info.rankname,\r\n    };\r\n  }\r\n\r\n  get getMusicList() {\r\n    // @ts-ignore\r\n    // eslint-disable-next-line\r\n    return this.rankInfo.songs.list;\r\n  }\r\n\r\n  get formatDate() {\r\n    // @ts-ignore\r\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\r\n    const date = new Date(this.rankInfo.songs.timestamp * 1000);\r\n    return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(\r\n      2,\r\n      '0'\r\n    )}-${String(date.getDate()).padStart(2, '0')}`;\r\n  }\r\n\r\n  async ngOnInit(): Promise<void> {\r\n    const rankId = window.location.pathname.split('/').pop();\r\n    if (rankId === undefined) {\r\n      return;\r\n    }\r\n    this.rankInfo = await this.rankInfoService.fetchRankInfo(rankId);\r\n  }\r\n}\r\n","<section class=\"rank_info\" test-id=\"page-rank-info\">\r\n  <app-my-module-head [moduleHeadInfo]=\"getModuleHeadInfo\">\r\n    <ng-template>\r\n      <time class=\"rank_info__update_time\" slot=\"moduleUpdateTime\"\r\n        >{{ msg }} {{ formatDate }}</time\r\n      >\r\n    </ng-template>\r\n  </app-my-module-head>\r\n  <app-my-music-list [musicList]=\"getMusicList\">\r\n    <ng-template let-music>\r\n      <div\r\n        slot=\"default\"\r\n        [class]=\"['rank_info__index', 'rank_info__index' + (music.index + 1)]\"\r\n      >\r\n        {{ music.index + 1 }}\r\n      </div>\r\n    </ng-template>\r\n  </app-my-music-list>\r\n</section>\r\n","import { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { BASE_ORIGIN } from 'src/app/constants';\r\nimport { replaceSizeInUrl } from '../utils';\r\n\r\ntype RankItem = {\r\n  imgurl: string;\r\n  rankid: string;\r\n  rankname: string;\r\n  imgUrl: string;\r\n  path: string;\r\n  title: string;\r\n};\r\nexport type RankListResponse = {\r\n  rank: {\r\n    list: RankItem[];\r\n  };\r\n};\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class RankListService {\r\n  rankListUrl = `${BASE_ORIGIN}/rank/list&json=true`;\r\n\r\n  constructor(private http: HttpClient) {}\r\n\r\n  async fetchRankList(params = {}): Promise<RankItem[]> {\r\n    const response = await this.http\r\n      .get<RankListResponse>(this.rankListUrl, {\r\n        params: { ...params },\r\n        observe: 'body',\r\n        responseType: 'json',\r\n      })\r\n      .toPromise();\r\n    response.rank.list.forEach((obj) => {\r\n      obj.imgUrl = replaceSizeInUrl(obj.imgurl);\r\n      obj.path = `/rank/info/${obj.rankid}`;\r\n      obj.title = obj.rankname;\r\n    });\r\n    return response.rank.list;\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { RankListComponent } from './rank-list/rank-list.component';\r\nimport { RankInfoComponent } from './rank-info/rank-info.component';\r\nimport { MyMainComponent } from '../../components/my-main/my-main.component';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: 'list',\r\n    component: MyMainComponent,\r\n    children: [\r\n      {\r\n        path: '',\r\n        component: RankListComponent,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    path: 'info/:rankId',\r\n    component: RankInfoComponent,\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class RankRoutingModule {}\r\n"],"sourceRoot":"webpack:///"}