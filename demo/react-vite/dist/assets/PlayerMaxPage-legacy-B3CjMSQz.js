System.register(["./index-legacy-nyrymUJ9.js","./useNextPrevSong-legacy-BcAeZzO2.js","./index-legacy-DHxPQBSR.js"],function(e,r){"use strict";var a,t,n,o,l,c,s,i,u,_,v,d;return{setters:[e=>{a=e.a,t=e.d,n=e.u,o=e.j,l=e.f,c=e.e,s=e.b},e=>{i=e.P,u=e.a,_=e.N,v=e.u},e=>{d=e.u}],execute:function(){var r=document.createElement("style");r.textContent=".PlayerMax-module__PlayerMax__nFr9t{position:relative}.PlayerMax-module__PlayerMax__mask__O5dge{position:absolute;left:0;top:0;filter:blur(calc(var(--vw, 1vw) * 4));width:100%;height:100%;display:block;background-repeat:no-repeat,no-repeat;background-size:auto 100%,auto 100%;background-position:center,center;z-index:-1}.PlayerMax-module__PlayerMax__container__78jAB{display:flex;flex-flow:column;align-items:center;height:100%;background-color:rgba(0,0,0,.6);width:100%;box-sizing:border-box;overflow:hidden}.PlayerMax-module__PlayerMax__songName__LaOPN{height:calc((var(--vh) * 100 - calc(var(--vw, 1vw) * 100) * 58 / 375) * 54 / 609);line-height:calc((var(--vh) * 100 - calc(var(--vw, 1vw) * 100) * 58 / 375) * 54 / 609);width:calc(100% - calc((var(--vh) * 100 - calc(var(--vw, 1vw) * 100) * 58 / 375) * 120 / 609));box-sizing:border-box;margin:0 calc((var(--vh) * 100 - calc(var(--vw, 1vw) * 100) * 58 / 375) * 120 / 609);overflow-x:auto;overflow-y:hidden;white-space:nowrap;color:#fff;text-align:center;font-size:inherit}.PlayerMax-module__PlayerMax__singerImg__zLqtL{margin-top:calc((var(--vh) * 100 - calc(var(--vw, 1vw) * 100) * 58 / 375) * 26 / 609);height:calc((var(--vh) * 100 - calc(var(--vw, 1vw) * 100) * 58 / 375) * 193 / 609);width:calc((var(--vh) * 100 - calc(var(--vw, 1vw) * 100) * 58 / 375) * 193 / 609);flex:0 0 auto;border-radius:50%;animation:PlayerMax-module__rotate__Vs2fB 20s linear infinite reverse;animation-play-state:paused}.PlayerMax-module__PlayerMax__singerImg--active__JzhE5{animation-play-state:running}.PlayerMax-module__PlayerMax__progress__mqqzK{height:calc((var(--vh) * 100 - calc(var(--vw, 1vw) * 100) * 58 / 375) * 48 / 609);width:100%;box-sizing:border-box}.PlayerMax-module__PlayerMax__buttonContainer__CH7mY{height:calc((var(--vh) * 100 - calc(var(--vw, 1vw) * 100) * 58 / 375) * 58 / 609);display:flex;align-items:center;justify-content:center}.PlayerMax-module__PlayerMax__prevBtn__lEN41,.PlayerMax-module__PlayerMax__nextBtn__JsiF1,.PlayerMax-module__PlayerMax__playBtn__q-uA3{border-radius:50%;border:calc((var(--vh) * 100 - calc(var(--vw, 1vw) * 100) * 58 / 375) * 2 / 609) solid #fff;margin:0 calc((var(--vh) * 100 - calc(var(--vw, 1vw) * 100) * 58 / 375) * 16 / 609)}.PlayerMax-module__PlayerMax__prevBtn__lEN41,.PlayerMax-module__PlayerMax__nextBtn__JsiF1{width:calc((var(--vh) * 100 - calc(var(--vw, 1vw) * 100) * 58 / 375) * 42 / 609);height:calc((var(--vh) * 100 - calc(var(--vw, 1vw) * 100) * 58 / 375) * 42 / 609);font-size:calc((var(--vh) * 100 - calc(var(--vw, 1vw) * 100) * 58 / 375) * 16 / 609)}.PlayerMax-module__PlayerMax__prevBtn__lEN41 .PlayerMax-module__icon__e19QT{transform:translate(0)}.PlayerMax-module__PlayerMax__nextBtn__JsiF1 .PlayerMax-module__icon__e19QT{transform:translate(1px)}.PlayerMax-module__PlayerMax__playBtn__q-uA3{width:calc((var(--vh) * 100 - calc(var(--vw, 1vw) * 100) * 58 / 375) * 58 / 609);height:calc((var(--vh) * 100 - calc(var(--vw, 1vw) * 100) * 58 / 375) * 58 / 609);font-size:calc((var(--vh) * 100 - calc(var(--vw, 1vw) * 100) * 58 / 375) * 20 / 609)}.PlayerMax-module__PlayerMax__download__6-SnC{margin-top:calc((var(--vh) * 100 - calc(var(--vw, 1vw) * 100) * 58 / 375) * 19 / 609) auto 0;height:calc((var(--vh) * 100 - calc(var(--vw, 1vw) * 100) * 58 / 375) * 45 / 609);width:calc((var(--vh) * 100 - calc(var(--vw, 1vw) * 100) * 58 / 375) * 211 / 609)}.PlayerLyric-module__PlayerLyric__FPEtF{color:#ccc;overflow:scroll;font-size:calc(var(--vw, 1vw) * 4);margin-top:calc((var(--vh) * 100 - calc(var(--vw, 1vw) * 100) * 58 / 375) * 16 / 609);height:calc((var(--vh) * 100 - calc(var(--vw, 1vw) * 100) * 58 / 375) * 68 / 609);line-height:calc((var(--vh) * 100 - calc(var(--vw, 1vw) * 100) * 58 / 375) * 34 / 609);width:102%;box-sizing:border-box;padding:0 calc(var(--vw, 1vw) * 16)}.PlayerLyric-module__PlayerLyric__FPEtF{text-align:center}.PlayerLyric-module__PlayerLyric_text__TGvUV{line-height:inherit}.PlayerLyric-module__PlayerLyric_text--active__KL5iT{color:#d1c90e}.PlayerProgress-module__PlayerProgress__zfweH{font-size:calc(var(--vw, 1vw) * 3.2);padding:calc(var(--vw, 1vw) * 4.26667) calc(var(--vw, 1vw) * 3.46667);display:flex;justify-content:space-between;align-items:center;color:#e5e5e5;height:calc((var(--vh) * 100 - calc(var(--vw, 1vw) * 100) * 58 / 375) * 48 / 609);width:100%;box-sizing:border-box}.PlayerProgress-module__PlayerProgress__songCurTime__A7-HE,.PlayerProgress-module__PlayerProgress__songDuration__Gvntj{flex:0 0 auto}.PlayerProgress-module__PlayerProgress__progressBar__cjUc4{flex:1 0 auto;height:calc(var(--vw, 1vw) * 1.06667);margin:0 calc(var(--vw, 1vw) * 2.66667);background-color:#232228;position:relative}.PlayerProgress-module__PlayerProgress__progressBarPointer__d5hpm{position:absolute;left:0;top:50%;transform:translate(-50%,-50%);background:#2ca2f9;height:calc(var(--vw, 1vw) * 3.46667);width:calc(var(--vw, 1vw) * 3.46667);border-radius:50%}\n/*$vite$:1*/",document.head.appendChild(r);const y="PlayerMax-module__PlayerMax__mask__O5dge",g="PlayerMax-module__PlayerMax__container__78jAB",m="PlayerMax-module__PlayerMax__songName__LaOPN",f="PlayerMax-module__PlayerMax__singerImg__zLqtL",p="PlayerMax-module__PlayerMax__singerImg--active__JzhE5",h="PlayerMax-module__PlayerMax__buttonContainer__CH7mY",x="PlayerMax-module__PlayerMax__prevBtn__lEN41",P="PlayerMax-module__PlayerMax__nextBtn__JsiF1",w="PlayerMax-module__PlayerMax__playBtn__q-uA3",M="PlayerMax-module__PlayerMax__download__6-SnC",b="PlayerLyric-module__PlayerLyric__FPEtF",j="PlayerLyric-module__PlayerLyric_text__TGvUV",N="PlayerLyric-module__PlayerLyric_text--active__KL5iT";var L=e=>Array.isArray(e)?e:[e];function S(e){const r=Array.isArray(e[0])?e[0]:e;return function(e,r="expected all items to be functions, instead received the following types: "){if(!e.every(e=>"function"==typeof e)){const a=e.map(e=>"function"==typeof e?`function ${e.name||"unnamed"}()`:typeof e).join(", ");throw new TypeError(`${r}[${a}]`)}}(r,"createSelector expects all input-selectors to be functions, but received the following types: "),r}var E="undefined"!=typeof WeakRef?WeakRef:class{constructor(e){this.value=e}deref(){return this.value}};function z(){return{s:0,v:void 0,o:null,p:null}}function T(e,r={}){let a={s:0,v:void 0,o:null,p:null};const{resultEqualityCheck:t}=r;let n,o=0;function l(){let r=a;const{length:l}=arguments;for(let e=0,a=l;e<a;e++){const a=arguments[e];if("function"==typeof a||"object"==typeof a&&null!==a){let e=r.o;null===e&&(r.o=e=new WeakMap);const t=e.get(a);void 0===t?(r=z(),e.set(a,r)):r=t}else{let e=r.p;null===e&&(r.p=e=new Map);const t=e.get(a);void 0===t?(r=z(),e.set(a,r)):r=t}}const c=r;let s;if(1===r.s)s=r.v;else if(s=e.apply(null,arguments),o++,t){const e=n?.deref?.()??n;null!=e&&t(e,s)&&(s=e,0!==o&&o--),n="object"==typeof s&&null!==s||"function"==typeof s?new E(s):s}return c.s=1,c.v=s,s}return l.clearCache=()=>{a={s:0,v:void 0,o:null,p:null},l.resetResultsCount()},l.resultsCount=()=>o,l.resetResultsCount=()=>{o=0},l}function R(e,...r){const a="function"==typeof e?{memoize:e,memoizeOptions:r}:e,t=(...e)=>{let r,t=0,n=0,o={},l=e.pop();"object"==typeof l&&(o=l,l=e.pop()),function(e,r="expected a function, instead received "+typeof e){if("function"!=typeof e)throw new TypeError(r)}(l,`createSelector expects an output function after the inputs, but received: [${typeof l}]`);const c={...a,...o},{memoize:s,memoizeOptions:i=[],argsMemoize:u=T,argsMemoizeOptions:_=[]}=c,v=L(i),d=L(_),y=S(e),g=s(function(){return t++,l.apply(null,arguments)},...v),m=u(function(){n++;const e=function(e,r){const a=[],{length:t}=e;for(let n=0;n<t;n++)a.push(e[n].apply(null,r));return a}(y,arguments);return r=g.apply(null,e),r},...d);return Object.assign(m,{resultFunc:l,memoizedResultFunc:g,dependencies:y,dependencyRecomputations:()=>n,resetDependencyRecomputations:()=>{n=0},lastResult:()=>r,recomputations:()=>t,resetRecomputations:()=>{t=0},memoize:s,argsMemoize:u})};return Object.assign(t,{withTypes:()=>t}),t}var B=R(T),I=Object.assign((e,r=B)=>{!function(e,r="expected an object, instead received "+typeof e){if("object"!=typeof e)throw new TypeError(r)}(e,"createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);const a=Object.keys(e);return r(a.map(r=>e[r]),(...e)=>e.reduce((e,r,t)=>(e[a[t]]=r,e),{}))},{withTypes:()=>I});const k=B([e=>e],e=>{const r=e.split(/\n/);return r.pop(),r.map(e=>{const r=e.replace("[","").split("]"),a=r[0],t=a.split(":")[0],n=a.split(":")[1].split(".")[0],o=a.split(":")[1].split(".")[1];return{millisecond:60*Number(t)*1e3+1e3*Number(n)+Number(o),text:r[1].trim().replace(/(男[:：]\s*)|(女[:：]\s*)/,"")}})}),C=()=>{const{lyrics:e,prevLyricIndex:r,toggleIsTouching:c}=function(){const[e,r]=a.useState(0),[o,l]=a.useState(!1),{songInfo:{lyric:c},audioElRef:s}=t(),i=n(e=>{l(e)}),u=n(e=>{if(o)return;const a=k(c).map(e=>e.millisecond),t=Math.floor(1e3*e.target.currentTime),n=a.findIndex(e=>e>1.005*t);r(n>1?n-2:0)});return a.useEffect(()=>{const e=s.current;if(e)return e.addEventListener("timeupdate",u),()=>{e.removeEventListener("timeupdate",u)}},[s,u]),{lyrics:k(c),prevLyricIndex:e,toggleIsTouching:i}}(),s=a.useRef([]);return a.useEffect(()=>{s.current[r]?.scrollIntoView()},[r]),o.jsx("div",{className:b,onTouchStart:()=>c(!0),onTouchEnd:()=>c(!1),children:e.map((e,a)=>o.jsx("p",{ref:e=>((e,r)=>(s.current[e]=r,()=>{s.current.splice(e,1)}))(a,e),className:l(j,{[N]:a===r+1}),children:e.text},a))})},F="PlayerProgress-module__PlayerProgress__zfweH",A="PlayerProgress-module__PlayerProgress__songCurTime__A7-HE",O="PlayerProgress-module__PlayerProgress__songDuration__Gvntj",$="PlayerProgress-module__PlayerProgress__progressBar__cjUc4",q="PlayerProgress-module__PlayerProgress__progressBarPointer__d5hpm";function H(e){if(isNaN(Number(e)))return"00:00";const r=Math.floor(Number(e)),a=r%60,t=Math.floor(r/60);return String(t).padStart(2,"0")+":"+String(a).padStart(2,"0")}const J=()=>{const{audioElRef:e,progressBarRef:r,currentTime:l,currentProgress:c,loadProgress:s,onTouchStart:i}=function(){const{audioElRef:e}=t(),[r,o]=a.useState(0),[l,c]=a.useState(0),[s,i]=a.useState(0),[u,_]=a.useState(!1),v=a.useRef(null),y=a.useRef(null),g=a.useRef(0),m=n((a,t,n)=>{const o=(a-t)/y.current.width;let l;const c=e.current;switch(n){case 0:l=c.duration*o;break;case 1:l=r+c.duration*o}return l<0?l=0:l>c.duration&&(l=c.duration),l}),f=n(()=>{const r=e.current;if(r.readyState<2)return;const a=r.buffered.length,t=Math.floor(100*r.buffered.end(a-1)/r.duration);c(t)}),p=n(r=>{if(u)return;const a=e.current,t=r.target.currentTime,n=Math.floor(100*t/a.duration);o(t),i(n)}),h=n(r=>{const a=r.touches[0].clientX,t=m(a,g.current,1),n=e.current,l=Math.floor(100*t/n.duration);o(t),i(l),g.current=a}),x=n(()=>{const a=e.current;_(!1),Number.isNaN(r)||(a.currentTime=r),window.removeEventListener("touchmove",h),window.removeEventListener("touchend",x)}),P=n(r=>{_(!0),y.current||(y.current=v.current.getBoundingClientRect());const a=r.touches[0].clientX,t=m(a,y.current.left,0),n=e.current,l=Math.floor(100*t/n.duration);o(t),i(l),g.current=a,window.addEventListener("touchmove",h),window.addEventListener("touchend",x)});return d("progress",f,{target:()=>e.current}),d("timeupdate",p,{target:()=>e.current}),{audioElRef:e,progressBarRef:v,currentTime:r,loadProgress:l,currentProgress:s,onTouchStart:P}}(),u=null===e.current?{duration:0}:e.current,_={backgroundImage:`linear-gradient(to right, #2ca2f9 ${c}%, transparent ${c}%),linear-gradient(to right, #6c6b70 ${s}%, transparent ${s}%)`,color:"red"};return o.jsxs("div",{className:F,onTouchStart:i,children:[o.jsx("div",{className:A,children:H(l)}),o.jsx("div",{className:$,ref:r,style:_,children:o.jsx("div",{className:q,style:{left:c+"%"}})}),o.jsx("div",{className:O,children:H(u.duration)})]})},U=({songInfo:{song_name:e,author_name:r,img:n},musicStatus:{isPlaying:c,isLoading:s},prevSong:v,nextSong:d})=>{const{togglePlay:b}=t();return o.jsxs(a.Fragment,{children:[o.jsx("div",{className:y,style:{backgroundImage:`url(${n}),linear-gradient(to right, rgb(48, 67, 82), rgb(215, 210, 204))`}}),o.jsxs("div",{className:g,children:[o.jsx("h6",{className:m,children:e}),o.jsx("img",{src:n,className:l(f,{[p]:c}),alt:r}),o.jsx(C,{}),o.jsx(J,{}),o.jsxs("div",{className:h,children:[o.jsx(i,{className:x,prev:v}),o.jsx(u,{className:w,isLoading:s,isPlaying:c,togglePlay:b}),o.jsx(_,{className:P,next:d})]}),o.jsx("button",{className:M})]})]})};e("default",()=>{const e=c(),r=s(),{musicStatus:n,songInfo:l,audioElRef:i,songIndex:u,songList:_,fetchMusicIfNeeded:d}=t();a.useEffect(()=>{const{play_url:r}=l;if(""===r){const r=new URLSearchParams(e.search).get("musicHash");r&&d(r,0,[{hash:r}])}},[e.search,l,d]);const y={musicStatus:n,songInfo:l,audioElRef:i,songIndex:u,songList:_,location:e,navigate:r},{nextSong:g,prevSong:m}=v(_,u);return o.jsx(U,{...y,nextSong:g,prevSong:m})})}}});
