System.register(["./index-legacy-CHfQ7Ag6.js","./utils-legacy-qDOP3u-a.js"],function(e,t){"use strict";var r,s,a,i,n,c,o,u,h,l,d,p,f,y,v,_,m,w,b,S,R,g,Q,x,I,k,C,O,T;return{setters:[e=>{r=e.S,s=e.o,a=e.q,i=e.t,n=e.v,c=e.w,o=e.x,u=e.y,h=e.z,l=e.B,d=e.C,p=e.D,f=e.E,y=e.F,v=e.d,_=e.G,m=e.H,w=e.h,b=e.i,S=e.P,R=e.I,g=e.j,Q=e.g,x=e.A,I=e.e,k=e.a,C=e.J,O=e.u},e=>{T=e.i}],execute:function(){var t=document.createElement("style");t.textContent=".Search-module__Search__container__x517w{overflow:scroll;box-sizing:border-box;height:calc(100% - calc(var(--vw, 1vw) * 14.4))}.Search-module__Search__form__16NmP{box-sizing:border-box;height:calc(var(--vw, 1vw) * 16.8);padding:calc(var(--vw, 1vw) * 3.46667);background-color:#fbfbfb}.Search-module__Search__keyword__I1M4w,.Search-module__Search__btn__grEzC{box-sizing:border-box;height:100%;border-radius:calc(var(--vw, 1vw) * 1.33333)}.Search-module__Search__keyword__I1M4w{width:calc(var(--vw, 1vw) * 73.86667);margin-right:calc(var(--vw, 1vw) * 2.66667);padding:calc(var(--vw, 1vw) * 1.86667) 1px calc(var(--vw, 1vw) * 1.86667) calc(var(--vw, 1vw) * 8.26667);border:1px solid #e5e5e5;background-color:#fff}.Search-module__Search__btn__grEzC{width:calc(var(--vw, 1vw) * 16);color:#959595;background-color:#e5e5e5}.Search-module__Search__btn--active__Pc7A7{color:#fff;background:#2ca2f9}.Search-module__Search__type__gggH4{height:calc(var(--vw, 1vw) * 13.6);padding-left:calc(var(--vw, 1vw) * 4.26667);color:#2ca2f9;border-bottom:1px solid #ccc;font-size:calc(var(--vw, 1vw) * 4.26667);line-height:calc(var(--vw, 1vw) * 13.6)}.Search-module__Search__item__jjkRl{height:calc(var(--vw, 1vw) * 17.06667);margin-left:calc(var(--vw, 1vw) * 4.26667);font-size:calc(var(--vw, 1vw) * 5.33333);line-height:calc(var(--vw, 1vw) * 17.06667)}.Search-module__Search__count__F8r9w{box-sizing:border-box;width:100%;padding-left:calc(var(--vw, 1vw) * 4.26667);color:#959595;background-color:#e5e5e5;font-size:calc(var(--vw, 1vw) * 3.73333);line-height:calc(var(--vw, 1vw) * 7.46667)}.Search-module__Search__resultList__fmd8J{overflow-y:scroll}\n/*$vite$:1*/",document.head.appendChild(t);var E=class extends r{constructor(e,t){super(),this.options=t,this.#e=e,this.#t=null,this.#r=s(),this.bindMethods(),this.setOptions(t)}#e;#s=void 0;#a=void 0;#i=void 0;#n;#c;#r;#t;#o;#u;#h;#l;#d;#p;#f=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#s.addObserver(this),F(this.#s,this.options)?this.#y():this.updateResult(),this.#v())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return j(this.#s,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return j(this.#s,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#_(),this.#m(),this.#s.removeObserver(this)}setOptions(e){const t=this.options,r=this.#s;if(this.options=this.#e.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof a(this.options.enabled,this.#s))throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#w(),this.#s.setOptions(this.options),t._defaulted&&!i(this.options,t)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#s,observer:this});const s=this.hasListeners();s&&D(this.#s,r,this.options,t)&&this.#y(),this.updateResult(),!s||this.#s===r&&a(this.options.enabled,this.#s)===a(t.enabled,this.#s)&&n(this.options.staleTime,this.#s)===n(t.staleTime,this.#s)||this.#b();const c=this.#S();!s||this.#s===r&&a(this.options.enabled,this.#s)===a(t.enabled,this.#s)&&c===this.#p||this.#R(c)}getOptimisticResult(e){const t=this.#e.getQueryCache().build(this.#e,e),r=this.createResult(t,e);return s=r,!i(this.getCurrentResult(),s)&&(this.#i=r,this.#c=this.options,this.#n=this.#s.state),r;var s}getCurrentResult(){return this.#i}trackResult(e,t){return new Proxy(e,{get:(e,r)=>(this.trackProp(r),t?.(r),"promise"===r&&(this.trackProp("data"),this.options.experimental_prefetchInRender||"pending"!==this.#r.status||this.#r.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(e,r))})}trackProp(e){this.#f.add(e)}getCurrentQuery(){return this.#s}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=this.#e.defaultQueryOptions(e),r=this.#e.getQueryCache().build(this.#e,t);return r.fetch().then(()=>this.createResult(r,t))}fetch(e){return this.#y({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#i))}#y(e){this.#w();let t=this.#s.fetch(this.options,e);return e?.throwOnError||(t=t.catch(c)),t}#b(){this.#_();const e=n(this.options.staleTime,this.#s);if(o||this.#i.isStale||!u(e))return;const t=h(this.#i.dataUpdatedAt,e)+1;this.#l=l.setTimeout(()=>{this.#i.isStale||this.updateResult()},t)}#S(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#s):this.options.refetchInterval)??!1}#R(e){this.#m(),this.#p=e,!o&&!1!==a(this.options.enabled,this.#s)&&u(this.#p)&&0!==this.#p&&(this.#d=l.setInterval(()=>{(this.options.refetchIntervalInBackground||d.isFocused())&&this.#y()},this.#p))}#v(){this.#b(),this.#R(this.#S())}#_(){this.#l&&(l.clearTimeout(this.#l),this.#l=void 0)}#m(){this.#d&&(l.clearInterval(this.#d),this.#d=void 0)}createResult(e,t){const r=this.#s,i=this.options,n=this.#i,c=this.#n,o=this.#c,u=e!==r?e.state:this.#a,{state:h}=e;let l,d={...h},y=!1;if(t._optimisticResults){const s=this.hasListeners(),a=!s&&F(e,t),n=s&&D(e,r,t,i);(a||n)&&(d={...d,...p(h.data,e.options)}),"isRestoring"===t._optimisticResults&&(d.fetchStatus="idle")}let{error:v,errorUpdatedAt:_,status:m}=d;l=d.data;let w=!1;if(void 0!==t.placeholderData&&void 0===l&&"pending"===m){let e;n?.isPlaceholderData&&t.placeholderData===o?.placeholderData?(e=n.data,w=!0):e="function"==typeof t.placeholderData?t.placeholderData(this.#h?.state.data,this.#h):t.placeholderData,void 0!==e&&(m="success",l=f(n?.data,e,t),y=!0)}if(t.select&&void 0!==l&&!w)if(n&&l===c?.data&&t.select===this.#o)l=this.#u;else try{this.#o=t.select,l=t.select(l),l=f(n?.data,l,t),this.#u=l,this.#t=null}catch(I){this.#t=I}this.#t&&(v=this.#t,l=this.#u,_=Date.now(),m="error");const b="fetching"===d.fetchStatus,S="pending"===m,R="error"===m,g=S&&b,Q=void 0!==l,x={status:m,fetchStatus:d.fetchStatus,isPending:S,isSuccess:"success"===m,isError:R,isInitialLoading:g,isLoading:g,data:l,dataUpdatedAt:d.dataUpdatedAt,error:v,errorUpdatedAt:_,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>u.dataUpdateCount||d.errorUpdateCount>u.errorUpdateCount,isFetching:b,isRefetching:b&&!S,isLoadingError:R&&!Q,isPaused:"paused"===d.fetchStatus,isPlaceholderData:y,isRefetchError:R&&Q,isStale:P(e,t),refetch:this.refetch,promise:this.#r,isEnabled:!1!==a(t.enabled,e)};if(this.options.experimental_prefetchInRender){const t=e=>{"error"===x.status?e.reject(x.error):void 0!==x.data&&e.resolve(x.data)},a=()=>{const e=this.#r=x.promise=s();t(e)},i=this.#r;switch(i.status){case"pending":e.queryHash===r.queryHash&&t(i);break;case"fulfilled":"error"!==x.status&&x.data===i.value||a();break;case"rejected":"error"===x.status&&x.error===i.reason||a()}}return x}updateResult(){const e=this.#i,t=this.createResult(this.#s,this.options);this.#n=this.#s.state,this.#c=this.options,void 0!==this.#n.data&&(this.#h=this.#s),i(t,e)||(this.#i=t,this.#g({listeners:(()=>{if(!e)return!0;const{notifyOnChangeProps:t}=this.options,r="function"==typeof t?t():t;if("all"===r||!r&&!this.#f.size)return!0;const s=new Set(r??this.#f);return this.options.throwOnError&&s.add("error"),Object.keys(this.#i).some(t=>{const r=t;return this.#i[r]!==e[r]&&s.has(r)})})()}))}#w(){const e=this.#e.getQueryCache().build(this.#e,this.options);if(e===this.#s)return;const t=this.#s;this.#s=e,this.#a=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#v()}#g(e){y.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e(this.#i)}),this.#e.getQueryCache().notify({query:this.#s,type:"observerResultsUpdated"})})}};function F(e,t){return function(e,t){return!1!==a(t.enabled,e)&&void 0===e.state.data&&!("error"===e.state.status&&!1===t.retryOnMount)}(e,t)||void 0!==e.state.data&&j(e,t,t.refetchOnMount)}function j(e,t,r){if(!1!==a(t.enabled,e)&&"static"!==n(t.staleTime,e)){const s="function"==typeof r?r(e):r;return"always"===s||!1!==s&&P(e,t)}return!1}function D(e,t,r,s){return(e!==t||!1===a(s.enabled,e))&&(!r.suspense||"error"!==e.state.status)&&P(e,r)}function P(e,t){return!1!==a(t.enabled,e)&&e.isStaleByTime(n(t.staleTime,e))}var U=v.createContext(!1);U.Provider;var q=v.createContext(function(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}()),z=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function L(e,t,r){const s=v.useContext(U),a=v.useContext(q),i=m(),n=i.defaultQueryOptions(e);i.getDefaultOptions().queries?._experimental_beforeQuery?.(n),n._optimisticResults=s?"isRestoring":"optimistic",(e=>{if(e.suspense){const t=1e3,r=e=>"static"===e?e:Math.max(e??t,t),s=e.staleTime;e.staleTime="function"==typeof s?(...e)=>r(s(...e)):r(s),"number"==typeof e.gcTime&&(e.gcTime=Math.max(e.gcTime,t))}})(n),((e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))})(n,a),(e=>{v.useEffect(()=>{e.clearReset()},[e])})(a);const u=!i.getQueryCache().get(n.queryHash),[h]=v.useState(()=>new t(i,n)),l=h.getOptimisticResult(n),d=!s&&!1!==e.subscribed;if(v.useSyncExternalStore(v.useCallback(e=>{const t=d?h.subscribe(y.batchCalls(e)):c;return h.updateResult(),t},[h,d]),()=>h.getCurrentResult(),()=>h.getCurrentResult()),v.useEffect(()=>{h.setOptions(n)},[n,h]),((e,t)=>e?.suspense&&t.isPending)(n,l))throw z(n,h,a);if((({result:e,errorResetBoundary:t,throwOnError:r,query:s,suspense:a})=>e.isError&&!t.isReset()&&!e.isFetching&&s&&(a&&void 0===e.data||_(r,[e.error,s])))({result:l,errorResetBoundary:a,throwOnError:n.throwOnError,query:i.getQueryCache().get(n.queryHash),suspense:n.suspense}))throw l.error;if(i.getDefaultOptions().queries?._experimental_afterQuery?.(n,l),n.experimental_prefetchInRender&&!o&&((e,t)=>e.isLoading&&e.isFetching&&!t)(l,s)){const e=u?z(n,h,a):i.getQueryCache().get(n.queryHash)?.promise;e?.catch(c).finally(()=>{h.updateResult()})}return n.notifyOnChangeProps?l:h.trackResult(l)}function N(e,t){return L(e,E)}const M=({enabled:e=!0}={})=>N({queryKey:["hotSearch"],queryFn:async()=>({list:await async function(){return(await w.get(b.hotSearch)).data.data.info}(),status:R}),enabled:e,initialData:{list:[],status:S}}),H=({keyword:e="",enabled:t=!0}={})=>N({queryKey:["keywordSearch",e],queryFn:async()=>{const t=await async function(e){const t=await w.get(`${b.keywordSearch}${e}`);return{list:t.data.data.info,total:t.data.data.total}}(e);return{...t,status:R}},enabled:t&&!!e,initialData:{list:[],total:0,status:S}}),A="Search-module__Search__container__x517w",K="Search-module__Search__form__16NmP",W="Search-module__Search__keyword__I1M4w",B="Search-module__Search__btn__grEzC",$="Search-module__Search__btn--active__Pc7A7",J="Search-module__Search__type__gggH4",G="Search-module__Search__item__jjkRl",V="Search-module__Search__count__F8r9w",X="Search-module__Search__resultList__fmd8J",Y=({isKeywordSearchShow:e,isHotSearchShow:t,keyword:r,updateKeyword:s,searchKeyword:a,hotSearch:{list:i},keywordSearch:{list:n,total:c}})=>g.jsxs(v.Fragment,{children:[g.jsx("h4",{className:"main_box_shadow module_title",children:"搜索"}),g.jsxs("div",{className:A,children:[g.jsxs("form",{className:K,onSubmit:e=>e.preventDefault(),children:[g.jsx("input",{type:"text",placeholder:"歌手/歌名/拼音",className:W,value:r,onChange:e=>s(e.target.value),onKeyUp:e=>T(e)?a():void 0}),g.jsx("button",{className:Q(B,{[$]:e}),type:"button",onClick:a,children:"搜索"})]}),g.jsxs("div",{className:Q({hidden:!t}),children:[g.jsx("h6",{className:J,children:"最近热门"}),g.jsx("ul",{children:i.map(e=>g.jsx("li",{className:Q(G,"main_border_bottom"),onClick:t=>s(e.keyword,a),children:e.keyword},e.keyword))})]}),g.jsxs("div",{className:Q({hidden:!e}),children:[g.jsxs("div",{className:V,children:["共有",c,"条结果"]}),g.jsx(x,{data:n,className:X})]})]})]});e("default",()=>{const e=I(),t=k(),[r]=C(),[s,a]=v.useState(!1),[i,n]=v.useState(!1),[c,o]=v.useState(""),u=v.useRef(null),{data:h,refetch:l}=M({enabled:!1}),{data:d,refetch:p}=H({keyword:r.get("keyword")||"",enabled:!1}),f=O(({search:e})=>{const t=new URLSearchParams(e).get("keyword");null===t||""===t?(l(),n(!0),a(!1),o("")):(p(),n(!1),a(!0),o(t))}),y=O((e,t=()=>{})=>{o(e),u.current=t}),_=O(()=>{const{search:r,pathname:s}=e;if(""===c)return void t(s);const a=new URLSearchParams(r),i=null!==a.get("keyword");a.set("keyword",c),i?t(s+"?"+a.toString(),{replace:!0}):t(s+"?"+a.toString())});v.useEffect(()=>{f(e)},[e,f]),v.useEffect(()=>{u.current&&(u.current(),u.current=null)},[c]);const m={isKeywordSearchShow:s,isHotSearchShow:i,keyword:c,searchKeyword:_,updateKeyword:y,hotSearch:h,keywordSearch:d};return g.jsx(Y,{...m})})}}});
