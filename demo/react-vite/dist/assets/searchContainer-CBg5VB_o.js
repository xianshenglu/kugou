import{d as _,S as f,B as K,e as S,f as u,C as x,D as R,E as l,r as d,j as a,G as k,h,A as E,P as o,c as C,u as N,b as j}from"./index-zccQ5I2P.js";const H=t=>({type:K,id:t}),g=t=>function(e,s){const{status:r}=s().hotSearch;r===_||r===f||(e(H()),S.get(u.hotSearch).then(i=>{e(v(i))}))},v=t=>({type:x,response:t}),b=t=>({type:R,id:t}),q=t=>function(e,s){let r=s().keywordSearch;t!==r.id&&(e(b(t)),S.get(u.keywordSearch+t).then(i=>{e(L(i,t))}))},L=(t,e)=>t.data.status===0?{type:l,response:t,id:e}:{type:l,response:t,id:e};class p extends d.Component{render(){const{isKeywordSearchShow:e,isHotSearchShow:s,keyword:r,updateKeyword:i,searchKeyword:n,hotSearch:{list:y},keywordSearch:{list:w,total:m}}=this.props;return a.jsxs(d.Fragment,{children:[a.jsx("h4",{className:"main_box_shadow module_title",children:"搜索"}),a.jsxs("div",{className:"Search__container",children:[a.jsxs("form",{className:"Search__form",onSubmit:c=>c.preventDefault(),children:[a.jsx("input",{type:"text",placeholder:"歌手/歌名/拼音",className:"Search__keyword",value:r,onChange:c=>i(c.target.value),onKeyUp:c=>k(c)?n():void 0}),a.jsx("button",{className:h("Search__btn",{"Search__btn--active":e}),type:"button",onClick:n,children:"搜索"})]}),a.jsxs("div",{className:h({hidden:!s}),children:[a.jsx("h6",{className:"Search__type",children:"最近热门"}),a.jsx("ul",{className:"Search__list",children:y.map(c=>a.jsx("li",{className:"Search__item main_border_bottom",onClick:I=>i(c.keyword,n),children:c.keyword},c.keyword))})]}),a.jsxs("div",{className:h({hidden:!e}),children:[a.jsxs("div",{className:"Search__count",children:["共有",m,"条结果"]}),a.jsx(E,{data:w,className:"Search__resultList"})]})]})]})}}p.propTypes={isKeywordSearchShow:o.bool.isRequired,isHotSearchShow:o.bool.isRequired,keyword:o.string.isRequired,updateKeyword:o.func.isRequired,searchKeyword:o.func.isRequired,hotSearch:o.shape({list:o.arrayOf(o.shape({keyword:o.string.isRequired})).isRequired}).isRequired,keywordSearch:o.shape({list:o.array.isRequired,total:o.number.isRequired}).isRequired};class D extends d.Component{constructor(e){super(e),this.state={isKeywordSearchShow:!1,isHotSearchShow:!1,keyword:""},this.searchKeyword=this.searchKeyword.bind(this),this.updateKeyword=this.updateKeyword.bind(this)}componentDidMount(){const{location:e}=this.props;this.historyListener(e)}componentDidUpdate(e){this.props.location!==e.location&&this.historyListener(this.props.location)}historyListener({search:e}){e=new URLSearchParams(e);const s=e.get("keyword"),{dispatch:r}=this.props;s===null||s===""?(r(g()),this.setState({isHotSearchShow:!0,isKeywordSearchShow:!1,keyword:""})):(r(q(s)),this.setState({isHotSearchShow:!1,isKeywordSearchShow:!0,keyword:s}))}updateKeyword(e,s=()=>{}){this.setState({keyword:e},s)}searchKeyword(){let{location:{search:e,pathname:s},navigate:r}=this.props;const{keyword:i}=this.state;if(i===""){r(s);return}e=new URLSearchParams(e);const n=e.get("keyword")!==null;e.set("keyword",i),n?r(s+"?"+e.toString(),{replace:!0}):r(s+"?"+e.toString())}render(){const{...e}=this.state,{searchKeyword:s,updateKeyword:r}=this,i={...e,searchKeyword:s,updateKeyword:r};return a.jsx(p,{...this.props,...i})}}const P=({hotSearch:t,keywordSearch:e})=>({hotSearch:t,keywordSearch:e}),T=null;function A(t){const e=N(),s=j();return a.jsx(D,{...t,location:e,navigate:s})}const U=C(P,T)(A);export{U as default};
