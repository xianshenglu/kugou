!function(){function e(r){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(r)}function r(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,a)}return t}function t(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach(function(r){o(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}function a(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,n,o,l,i=[],c=!0,u=!1;try{if(o=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;c=!1}else for(;!(c=(a=o.call(t)).done)&&(i.push(a.value),i.length!==r);c=!0);}catch(e){u=!0,n=e}finally{try{if(!c&&null!=t.return&&(l=t.return(),Object(l)!==l))return}finally{if(u)throw n}}return i}}(e,r)||function(e,r){if(e){if("string"==typeof e)return n(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?n(e,r):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,a=Array(r);t<r;t++)a[t]=e[t];return a}function o(r,t,a){return(t=function(r){var t=function(r,t){if("object"!=e(r)||!r)return r;var a=r[Symbol.toPrimitive];if(void 0!==a){var n=a.call(r,t||"default");if("object"!=e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(r)}(r,"string");return"symbol"==e(t)?t:t+""}(t))in r?Object.defineProperty(r,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[t]=a,r}System.register(["./index-legacy-CR1Gbylo.js","./useNextPrevSong-legacy-BAPi3nnP.js","./index-legacy-Dm8_wPa0.js","./utils-legacy--UzZy3sl.js"],function(e,r){"use strict";var n,l,i,c,u,s,_,d,y,v,f,g,m,P;return{setters:[function(e){n=e.a,l=e.j,i=e.f,c=e.H,u=e.u,s=e.G,_=e.b,d=e.E},function(e){y=e.P,v=e.a,f=e.N,g=e.u},function(e){m=e.u},function(e){P=e.s}],execute:function(){var r=document.createElement("style");r.textContent=".PlayerMax-module__PlayerMax__GI7rp{position:relative}.PlayerMax-module__PlayerMax__mask__z7UWn{position:absolute;left:0;top:0;filter:blur(4vw);width:100%;height:100%;display:block;background-repeat:no-repeat,no-repeat;background-size:auto 100%,auto 100%;background-position:center,center;z-index:-1}.PlayerMax-module__PlayerMax__container__rWV1E{display:flex;flex-flow:column;align-items:center;height:100%;background-color:rgba(0,0,0,.6);width:100%;box-sizing:border-box;overflow:hidden}.PlayerMax-module__PlayerMax__songName__2BJPh{height:calc((var(--vh) * 100 - 100vw * 58 / 375) * 54 / 609);line-height:calc((var(--vh) * 100 - 100vw * 58 / 375) * 54 / 609);width:calc(100% - calc((var(--vh) * 100 - 100vw * 58 / 375) * 120 / 609));box-sizing:border-box;margin:0 calc((var(--vh) * 100 - 100vw * 58 / 375) * 120 / 609);overflow-x:auto;overflow-y:hidden;white-space:nowrap;color:#fff;text-align:center;font-size:inherit}.PlayerMax-module__PlayerMax__singerImg__hQVu5{margin-top:calc((var(--vh) * 100 - 100vw * 58 / 375) * 26 / 609);height:calc((var(--vh) * 100 - 100vw * 58 / 375) * 193 / 609);width:calc((var(--vh) * 100 - 100vw * 58 / 375) * 193 / 609);flex:0 0 auto;border-radius:50%;animation:PlayerMax-module__rotate__D-oM2 20s linear infinite reverse;animation-play-state:paused}.PlayerMax-module__PlayerMax__singerImg--active__MB9YE{animation-play-state:running}.PlayerMax-module__PlayerMax__progress__E2aeC{height:calc((var(--vh) * 100 - 100vw * 58 / 375) * 48 / 609);width:100%;box-sizing:border-box}.PlayerMax-module__PlayerMax__buttonContainer__yhOqM{height:calc((var(--vh) * 100 - 100vw * 58 / 375) * 58 / 609);display:flex;align-items:center;justify-content:center}.PlayerMax-module__PlayerMax__prevBtn__RQgKy,.PlayerMax-module__PlayerMax__nextBtn__gvZBb,.PlayerMax-module__PlayerMax__playBtn__-S0Ok{border-radius:50%;border:calc((var(--vh) * 100 - 100vw * 58 / 375) * 2 / 609) solid #fff;margin:0 calc((var(--vh) * 100 - 100vw * 58 / 375) * 16 / 609)}.PlayerMax-module__PlayerMax__prevBtn__RQgKy,.PlayerMax-module__PlayerMax__nextBtn__gvZBb{width:calc((var(--vh) * 100 - 100vw * 58 / 375) * 42 / 609);height:calc((var(--vh) * 100 - 100vw * 58 / 375) * 42 / 609);font-size:calc((var(--vh) * 100 - 100vw * 58 / 375) * 16 / 609)}.PlayerMax-module__PlayerMax__prevBtn__RQgKy .PlayerMax-module__icon__mc5zy{transform:translate(0)}.PlayerMax-module__PlayerMax__nextBtn__gvZBb .PlayerMax-module__icon__mc5zy{transform:translate(1px)}.PlayerMax-module__PlayerMax__playBtn__-S0Ok{width:calc((var(--vh) * 100 - 100vw * 58 / 375) * 58 / 609);height:calc((var(--vh) * 100 - 100vw * 58 / 375) * 58 / 609);font-size:calc((var(--vh) * 100 - 100vw * 58 / 375) * 20 / 609)}.PlayerMax-module__PlayerMax__download__CpeMA{margin-top:calc((var(--vh) * 100 - 100vw * 58 / 375) * 19 / 609) auto 0;height:calc((var(--vh) * 100 - 100vw * 58 / 375) * 45 / 609);width:calc((var(--vh) * 100 - 100vw * 58 / 375) * 211 / 609)}.PlayerLyric-module__PlayerLyric__Vjiyd{color:#ccc;overflow:scroll;font-size:4vw;margin-top:calc((var(--vh) * 100 - 100vw * 58 / 375) * 16 / 609);height:calc((var(--vh) * 100 - 100vw * 58 / 375) * 68 / 609);line-height:calc((var(--vh) * 100 - 100vw * 58 / 375) * 34 / 609);width:102%;box-sizing:border-box;padding:0 16vw}.PlayerLyric-module__PlayerLyric__Vjiyd{text-align:center}.PlayerLyric-module__PlayerLyric_text__WcJar{line-height:inherit}.PlayerLyric-module__PlayerLyric_text--active__kWXfo{color:#d1c90e}.PlayerProgress-module__PlayerProgress__6-jfg{font-size:3.2vw;padding:4.26667vw 3.46667vw;display:flex;justify-content:space-between;align-items:center;color:#e5e5e5;height:calc((var(--vh) * 100 - 100vw * 58 / 375) * 48 / 609);width:100%;box-sizing:border-box}.PlayerProgress-module__PlayerProgress__songCurTime__t6PNA,.PlayerProgress-module__PlayerProgress__songDuration__6puld{flex:0 0 auto}.PlayerProgress-module__PlayerProgress__progressBar__lvqkw{flex:1 0 auto;height:1.06667vw;margin:0 2.66667vw;background-color:#232228;position:relative}.PlayerProgress-module__PlayerProgress__progressBarPointer__59B8e{position:absolute;left:0;top:50%;transform:translate(-50%,-50%);background:#2ca2f9;height:3.46667vw;width:3.46667vw;border-radius:50%}\n/*$vite$:1*/",document.head.appendChild(r);var h="PlayerMax-module__PlayerMax__mask__z7UWn",x="PlayerMax-module__PlayerMax__container__rWV1E",p="PlayerMax-module__PlayerMax__songName__2BJPh",b="PlayerMax-module__PlayerMax__singerImg__hQVu5",w="PlayerMax-module__PlayerMax__singerImg--active__MB9YE",M="PlayerMax-module__PlayerMax__buttonContainer__yhOqM",j="PlayerMax-module__PlayerMax__prevBtn__RQgKy",S="PlayerMax-module__PlayerMax__nextBtn__gvZBb",N="PlayerMax-module__PlayerMax__playBtn__-S0Ok",B="PlayerMax-module__PlayerMax__download__CpeMA",E="PlayerLyric-module__PlayerLyric__Vjiyd",L="PlayerLyric-module__PlayerLyric_text__WcJar",O="PlayerLyric-module__PlayerLyric_text--active__kWXfo",I=function(e){var r=e.lyrics,t=e.prevLyricIndex,a=e.toggleIsTouching,c=n.useRef([]);return n.useEffect(function(){var e;null===(e=c.current[t])||void 0===e||e.scrollIntoView()},[t]),l.jsx("div",{className:E,onTouchStart:function(){return a(!0)},onTouchEnd:function(){return a(!1)},children:r.map(function(e,r){return l.jsx("p",{ref:function(e){return function(e,r){return c.current[e]=r,function(){c.current.splice(e,1)}}(r,e)},className:i(L,o({},O,r===t+1)),children:e.text},r)})})},k=c([function(e){return e}],function(e){var r=e.split(/\n/);return r.pop(),r.map(function(e){var r=e.replace("[","").split("]"),t=r[0],a=t.split(":")[0],n=t.split(":")[1].split(".")[0],o=t.split(":")[1].split(".")[1];return{millisecond:60*Number(a)*1e3+1e3*Number(n)+Number(o),text:r[1].trim().replace(/(男[:：]\s*)|(女[:：]\s*)/,"")}})}),R=function(){var e=a(n.useState(0),2),r=e[0],o=e[1],i=a(n.useState(!1),2),c=i[0],_=i[1],d=u(),y=d.songInfo.lyric,v=d.audioElRef,f=s(function(e){_(e)}),g=s(function(e){if(!c){var r=k(y).map(function(e){return e.millisecond}),t=Math.floor(1e3*e.target.currentTime),a=r.findIndex(function(e){return e>1.005*t});o(a>1?a-2:0)}});n.useEffect(function(){var e=v.current;if(e)return e.addEventListener("timeupdate",g),function(){e.removeEventListener("timeupdate",g)}},[v]);var m={lyrics:k(y),prevLyricIndex:r,toggleIsTouching:f};return l.jsx(I,t({},m))},T="PlayerProgress-module__PlayerProgress__6-jfg",z="PlayerProgress-module__PlayerProgress__songCurTime__t6PNA",C="PlayerProgress-module__PlayerProgress__songDuration__6puld",A="PlayerProgress-module__PlayerProgress__progressBar__lvqkw",V="PlayerProgress-module__PlayerProgress__progressBarPointer__59B8e",W=function(e){var r=e.audioElRef.current,t=e.progressBarRef,a=e.currentTime,n=e.currentProgress,o=e.loadProgress,i=e.onTouchStart,c=null===r?{duration:0}:r,u={backgroundImage:"linear-gradient(to right, #2ca2f9 ".concat(n,"%, transparent ").concat(n,"%),linear-gradient(to right, #6c6b70 ").concat(o,"%, transparent ").concat(o,"%)"),color:"red"};return l.jsxs("div",{className:T,onTouchStart:i,children:[l.jsx("div",{className:z,children:P(a)}),l.jsx("div",{className:A,ref:t,style:u,children:l.jsx("div",{className:V,style:{left:n+"%"}})}),l.jsx("div",{className:C,children:P(c.duration)})]})},D=function(){var e=u().audioElRef,r=a(n.useState(0),2),o=r[0],i=r[1],c=a(n.useState(0),2),_=c[0],d=c[1],y=a(n.useState(0),2),v=y[0],f=y[1],g=a(n.useState(!1),2),P=g[0],h=g[1],x=n.useRef(null),p=n.useRef(null),b=n.useRef(0),w=s(function(r,t,a){var n,l=(r-t)/p.current.width,i=e.current;switch(a){case 0:n=i.duration*l;break;case 1:n=o+i.duration*l}return n<0?n=0:n>i.duration&&(n=i.duration),n}),M=s(function(){var r=e.current;if(!(r.readyState<2)){var t=r.buffered.length,a=Math.floor(100*r.buffered.end(t-1)/r.duration);d(a)}}),j=s(function(r){if(!P){var t=e.current,a=r.target.currentTime,n=Math.floor(100*a/t.duration);i(a),f(n)}}),S=s(function(r){var t=r.touches[0].clientX,a=w(t,b.current,1),n=e.current,o=Math.floor(100*a/n.duration);i(a),f(o),b.current=t}),N=s(function(){var r=e.current;h(!1),Number.isNaN(o)||(r.currentTime=o),window.removeEventListener("touchmove",S),window.removeEventListener("touchend",N)}),B=s(function(r){h(!0),p.current||(p.current=x.current.getBoundingClientRect());var t=r.touches[0].clientX,a=w(t,p.current.left,0),n=e.current,o=Math.floor(100*a/n.duration);i(a),f(o),b.current=t,window.addEventListener("touchmove",S),window.addEventListener("touchend",N)});m("progress",M,{target:function(){return e.current}}),m("timeupdate",j,{target:function(){return e.current}});var E={audioElRef:e,currentTime:o,loadProgress:_,currentProgress:v,isTouching:P,onTouchStart:B,progressBarRef:x};return l.jsx(W,t({},E))},Q=function(e){var r=e.songInfo,t=r.song_name,a=r.author_name,c=r.img,s=e.musicStatus,_=s.isPlaying,d=s.isLoading,g=e.prevSong,m=e.nextSong,P=u().togglePlay;return l.jsxs(n.Fragment,{children:[l.jsx("div",{className:h,style:{backgroundImage:"url(".concat(c,"),linear-gradient(to right, rgb(48, 67, 82), rgb(215, 210, 204))")}}),l.jsxs("div",{className:x,children:[l.jsx("h6",{className:p,children:t}),l.jsx("img",{src:c,className:i(b,o({},w,_)),alt:a}),l.jsx(R,{}),l.jsx(D,{}),l.jsxs("div",{className:M,children:[l.jsx(y,{className:j,prev:g}),l.jsx(v,{className:N,isLoading:d,isPlaying:_,togglePlay:P}),l.jsx(f,{className:S,next:m})]}),l.jsx("button",{className:B})]})]})};e("default",function(){var e=_(),r=d(),a=u(),o=a.musicStatus,i=a.songInfo,c=a.audioElRef,s=a.songIndex,y=a.songList,v=a.fetchMusicIfNeeded;n.useEffect(function(){if(""===i.play_url){var r=new URLSearchParams(e.search).get("musicHash");r&&v(r,0,[{hash:r}])}},[e.search,i,v]);var f={musicStatus:o,songInfo:i,audioElRef:c,songIndex:s,songList:y,location:e,navigate:r},m=g(y,s),P=m.nextSong,h=m.prevSong;return l.jsx(Q,t(t({},f),{},{nextSong:P,prevSong:h}))})}}})}();
