import{P as w,S as m,z as _,d as l,e as S,B as f,C as x,D as d,r as h,j as a,E as K,g as i,A as E,c as C,u as k,b as N}from"./index-CaPGCRQz.js";const j=t=>({type:_,id:t}),v=t=>function(e,s){const{status:r}=s().hotSearch;r===w||r===m||(e(j()),l.get(S.hotSearch).then(o=>{e(H(o))}))},H=t=>({type:f,response:t}),g=t=>({type:x,id:t}),b=t=>function(e,s){let r=s().keywordSearch;t!==r.id&&(e(g(t)),l.get(S.keywordSearch+t).then(o=>{e(R(o,t))}))},R=(t,e)=>t.data.status===0?{type:d,response:t,id:e}:{type:d,response:t,id:e};class L extends h.Component{render(){const{isKeywordSearchShow:e,isHotSearchShow:s,keyword:r,updateKeyword:o,searchKeyword:n,hotSearch:{list:p},keywordSearch:{list:u,total:y}}=this.props;return a.jsxs(h.Fragment,{children:[a.jsx("h4",{className:"main_box_shadow module_title",children:"搜索"}),a.jsxs("div",{className:"Search__container",children:[a.jsxs("form",{className:"Search__form",onSubmit:c=>c.preventDefault(),children:[a.jsx("input",{type:"text",placeholder:"歌手/歌名/拼音",className:"Search__keyword",value:r,onChange:c=>o(c.target.value),onKeyUp:c=>K(c)?n():void 0}),a.jsx("button",{className:i("Search__btn",{"Search__btn--active":e}),type:"button",onClick:n,children:"搜索"})]}),a.jsxs("div",{className:i({hidden:!s}),children:[a.jsx("h6",{className:"Search__type",children:"最近热门"}),a.jsx("ul",{className:"Search__list",children:p.map(c=>a.jsx("li",{className:"Search__item main_border_bottom",onClick:I=>o(c.keyword,n),children:c.keyword},c.keyword))})]}),a.jsxs("div",{className:i({hidden:!e}),children:[a.jsxs("div",{className:"Search__count",children:["共有",y,"条结果"]}),a.jsx(E,{data:u,className:"Search__resultList"})]})]})]})}}class D extends h.Component{constructor(e){super(e),this.state={isKeywordSearchShow:!1,isHotSearchShow:!1,keyword:""},this.searchKeyword=this.searchKeyword.bind(this),this.updateKeyword=this.updateKeyword.bind(this)}componentDidMount(){const{location:e}=this.props;this.historyListener(e)}componentDidUpdate(e){this.props.location!==e.location&&this.historyListener(this.props.location)}historyListener({search:e}){e=new URLSearchParams(e);const s=e.get("keyword"),{dispatch:r}=this.props;s===null||s===""?(r(v()),this.setState({isHotSearchShow:!0,isKeywordSearchShow:!1,keyword:""})):(r(b(s)),this.setState({isHotSearchShow:!1,isKeywordSearchShow:!0,keyword:s}))}updateKeyword(e,s=()=>{}){this.setState({keyword:e},s)}searchKeyword(){let{location:{search:e,pathname:s},navigate:r}=this.props;const{keyword:o}=this.state;if(o===""){r(s);return}e=new URLSearchParams(e);const n=e.get("keyword")!==null;e.set("keyword",o),n?r(s+"?"+e.toString(),{replace:!0}):r(s+"?"+e.toString())}render(){const{...e}=this.state,{searchKeyword:s,updateKeyword:r}=this,o={...e,searchKeyword:s,updateKeyword:r};return a.jsx(L,{...this.props,...o})}}const P=({hotSearch:t,keywordSearch:e})=>({hotSearch:t,keywordSearch:e}),A=null;function T(t){const e=k(),s=N();return a.jsx(D,{...t,location:e,navigate:s})}const F=C(P,A)(T);export{F as default};
